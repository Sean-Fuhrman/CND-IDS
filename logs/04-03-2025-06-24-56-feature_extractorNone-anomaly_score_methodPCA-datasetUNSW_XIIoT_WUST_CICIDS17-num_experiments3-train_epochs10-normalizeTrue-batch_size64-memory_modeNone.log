04-Mar-25 18:24:56 - Logging initialized with filename: 04-03-2025-06-24-56-feature_extractorNone-anomaly_score_methodPCA-datasetUNSW_XIIoT_WUST_CICIDS17-num_experiments3-train_epochs10-normalizeTrue-batch_size64-memory_modeNone
04-Mar-25 18:24:58 - Note: NumExpr detected 28 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
04-Mar-25 18:24:59 - Using Device: cuda
04-Mar-25 18:24:59 - Beginning experiment with settings: {'feature_extractor': [None], 'anomaly_score_method': ['PCA'], 'metrics': ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc'], 'dataset': ['UNSW', 'XIIoT', 'WUST', 'CICIDS17'], 'num_experiments': 3, 'train_epochs': 10, 'normalize': True, 'batch_size': 64, 'memory_mode': [None]}
04-Mar-25 18:24:59 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:24:59 - Loading dataset: UNSW
04-Mar-25 18:24:59 - Normalizing datastream UNSW
04-Mar-25 18:24:59 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:59 - Init normal shape: torch.Size([8312, 36])
04-Mar-25 18:24:59 - Train experience 0 X shape: torch.Size([62659, 36])
04-Mar-25 18:24:59 - Train experience 0 Y shape: torch.Size([62659])
04-Mar-25 18:24:59 - Train experience 1 X shape: torch.Size([15241, 36])
04-Mar-25 18:24:59 - Train experience 1 Y shape: torch.Size([15241])
04-Mar-25 18:24:59 - Train experience 2 X shape: torch.Size([37652, 36])
04-Mar-25 18:24:59 - Train experience 2 Y shape: torch.Size([37652])
04-Mar-25 18:24:59 - Train experience 3 X shape: torch.Size([50226, 36])
04-Mar-25 18:24:59 - Train experience 3 Y shape: torch.Size([50226])
04-Mar-25 18:24:59 - Train experience 4 X shape: torch.Size([32971, 36])
04-Mar-25 18:24:59 - Train experience 4 Y shape: torch.Size([32971])
04-Mar-25 18:24:59 - Test experience 0 X shape: torch.Size([15643, 36])
04-Mar-25 18:24:59 - Test experience 0 Y shape: torch.Size([15643])
04-Mar-25 18:24:59 - Test experience 1 X shape: torch.Size([3842, 36])
04-Mar-25 18:24:59 - Test experience 1 Y shape: torch.Size([3842])
04-Mar-25 18:24:59 - Test experience 2 X shape: torch.Size([9442, 36])
04-Mar-25 18:24:59 - Test experience 2 Y shape: torch.Size([9442])
04-Mar-25 18:24:59 - Test experience 3 X shape: torch.Size([12564, 36])
04-Mar-25 18:24:59 - Test experience 3 Y shape: torch.Size([12564])
04-Mar-25 18:24:59 - Test experience 4 X shape: torch.Size([8197, 36])
04-Mar-25 18:24:59 - Test experience 4 Y shape: torch.Size([8197])
04-Mar-25 18:24:59 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:59 - Percetage of normal in experience 0: 0.213792
04-Mar-25 18:24:59 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:59 - Percetage of normal in experience 1: 0.878945
04-Mar-25 18:24:59 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:59 - Percetage of normal in experience 2: 0.355785
04-Mar-25 18:24:59 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:59 - Percetage of normal in experience 3: 0.266714
04-Mar-25 18:24:59 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:59 - Percetage of normal in experience 4: 0.406236
04-Mar-25 18:24:59 - Beginning experiment 1/3
04-Mar-25 18:24:59 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:59 - Using PassThroughExtractor
04-Mar-25 18:24:59 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x000002399123AC90>
04-Mar-25 18:24:59 - --------- Beginning train experience 0 ----------
04-Mar-25 18:24:59 - X size: torch.Size([62659, 36]), y size: torch.Size([62659])
04-Mar-25 18:24:59 - Fitting feature extractor
04-Mar-25 18:24:59 - Encoding init normal data
04-Mar-25 18:24:59 - Fitting anomaly score method
04-Mar-25 18:24:59 - Fit anomaly score method
04-Mar-25 18:24:59 - Train Time: 0.012009
04-Mar-25 18:24:59 - --------- Testing all experiences ---------
04-Mar-25 18:24:59 - Scores Val Statisitcs: 0.026514, 0.013202
04-Mar-25 18:24:59 - Testing Experience 0
04-Mar-25 18:24:59 - Scores: [0.03834681 0.05424976 0.05383261 ... 0.06668872 0.08560976 0.03266874]
04-Mar-25 18:24:59 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:59 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:59 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:59 - Best F1 threshold : 0.016748667
04-Mar-25 18:24:59 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:59 - Metric Scores [0.2368119266055046, 0.5278836987607245, 0.891612509268548, 0.9331881465349615, 0.928773001643758, 0.973383600448825]
04-Mar-25 18:24:59 - Testing Experience 1
04-Mar-25 18:24:59 - Scores: [0.04076855 0.02291305 0.00771509 ... 0.01638828 0.00904685 0.01523162]
04-Mar-25 18:24:59 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:59 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:59 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:59 - Best F1 threshold : 0.03303366
04-Mar-25 18:24:59 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:59 - Metric Scores [0.06201550387596899, 0.2049586776859504, 0.35563380281690143, 0.3691073219658977, 0.7423637397309495, 0.3100029387629634]
04-Mar-25 18:24:59 - Testing Experience 2
04-Mar-25 18:24:59 - Scores: [0.00748155 0.01621025 0.01119728 ... 0.04391637 0.01102111 0.0244633 ]
04-Mar-25 18:24:59 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:59 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:59 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:59 - Best F1 threshold : 0.011582003
04-Mar-25 18:24:59 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:59 - Metric Scores [0.03859141341051616, 0.1492087415222306, 0.4368421052631579, 0.8073212258796821, 0.6841917150365403, 0.779688762834818]
04-Mar-25 18:24:59 - Testing Experience 3
04-Mar-25 18:24:59 - Scores: [0.00613217 0.03458637 0.01667811 ... 0.02460381 0.02313542 0.016961  ]
04-Mar-25 18:24:59 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:59 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:59 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:59 - Best F1 threshold : 0.010414476
04-Mar-25 18:24:59 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:59 - Metric Scores [0.047018955840304986, 0.16374269005847952, 0.5907099035933392, 0.8674396135265701, 0.7753426727810551, 0.8864928346861237]
04-Mar-25 18:24:59 - Testing Experience 4
04-Mar-25 18:24:59 - Scores: [0.01533421 0.05139586 0.0151626  ... 0.01088534 0.02339488 0.01940325]
04-Mar-25 18:24:59 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:59 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:59 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:59 - Best F1 threshold : 0.007748012
04-Mar-25 18:24:59 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:59 - Metric Scores [0.024791709002235318, 0.09811173836869769, 0.33839822728711616, 0.7500998322817667, 0.6245798760876865, 0.6905021231255926]
04-Mar-25 18:24:59 - Inference Time: 0.128684
04-Mar-25 18:24:59 - --------- Beginning train experience 1 ----------
04-Mar-25 18:24:59 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:24:59 - Train Time Statistics: 0.012009, nan
04-Mar-25 18:24:59 - Inference Time Statistics: 0.128684, nan
04-Mar-25 18:24:59 - Finished experiment 1/3
04-Mar-25 18:24:59 - Loading dataset: UNSW
04-Mar-25 18:24:59 - Normalizing datastream UNSW
04-Mar-25 18:24:59 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:59 - Init normal shape: torch.Size([8289, 36])
04-Mar-25 18:24:59 - Train experience 0 X shape: torch.Size([62678, 36])
04-Mar-25 18:24:59 - Train experience 0 Y shape: torch.Size([62678])
04-Mar-25 18:24:59 - Train experience 1 X shape: torch.Size([15266, 36])
04-Mar-25 18:24:59 - Train experience 1 Y shape: torch.Size([15266])
04-Mar-25 18:24:59 - Train experience 2 X shape: torch.Size([37711, 36])
04-Mar-25 18:24:59 - Train experience 2 Y shape: torch.Size([37711])
04-Mar-25 18:24:59 - Train experience 3 X shape: torch.Size([50091, 36])
04-Mar-25 18:24:59 - Train experience 3 Y shape: torch.Size([50091])
04-Mar-25 18:24:59 - Train experience 4 X shape: torch.Size([33023, 36])
04-Mar-25 18:24:59 - Train experience 4 Y shape: torch.Size([33023])
04-Mar-25 18:24:59 - Test experience 0 X shape: torch.Size([15629, 36])
04-Mar-25 18:24:59 - Test experience 0 Y shape: torch.Size([15629])
04-Mar-25 18:24:59 - Test experience 1 X shape: torch.Size([3822, 36])
04-Mar-25 18:25:00 - Test experience 1 Y shape: torch.Size([3822])
04-Mar-25 18:25:00 - Test experience 2 X shape: torch.Size([9388, 36])
04-Mar-25 18:25:00 - Test experience 2 Y shape: torch.Size([9388])
04-Mar-25 18:25:00 - Test experience 3 X shape: torch.Size([12704, 36])
04-Mar-25 18:25:00 - Test experience 3 Y shape: torch.Size([12704])
04-Mar-25 18:25:00 - Test experience 4 X shape: torch.Size([8150, 36])
04-Mar-25 18:25:00 - Test experience 4 Y shape: torch.Size([8150])
04-Mar-25 18:25:00 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:25:00 - Percetage of normal in experience 0: 0.213600
04-Mar-25 18:25:00 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:25:00 - Percetage of normal in experience 1: 0.876982
04-Mar-25 18:25:00 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:25:00 - Percetage of normal in experience 2: 0.355016
04-Mar-25 18:25:00 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:25:00 - Percetage of normal in experience 3: 0.267274
04-Mar-25 18:25:00 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:25:00 - Percetage of normal in experience 4: 0.405293
04-Mar-25 18:25:00 - Beginning experiment 2/3
04-Mar-25 18:25:00 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:00 - Using PassThroughExtractor
04-Mar-25 18:25:00 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997AA1520>
04-Mar-25 18:25:00 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:00 - X size: torch.Size([62678, 36]), y size: torch.Size([62678])
04-Mar-25 18:25:00 - Fitting feature extractor
04-Mar-25 18:25:00 - Encoding init normal data
04-Mar-25 18:25:00 - Fitting anomaly score method
04-Mar-25 18:25:00 - Fit anomaly score method
04-Mar-25 18:25:00 - Train Time: 0.013000
04-Mar-25 18:25:00 - --------- Testing all experiences ---------
04-Mar-25 18:25:00 - Scores Val Statisitcs: 0.026660, 0.012832
04-Mar-25 18:25:00 - Testing Experience 0
04-Mar-25 18:25:00 - Scores: [0.04342672 0.06502935 0.05436363 ... 0.07610385 0.02060528 0.00527574]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:25:00 - Best F1 threshold : 0.017714892
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.15833708539696834, 0.44088404787537205, 0.8899030233884769, 0.9383386455750994, 0.9333168093349846, 0.9736770843393594]
04-Mar-25 18:25:00 - Testing Experience 1
04-Mar-25 18:25:00 - Scores: [0.02779378 0.02097827 0.01103358 ... 0.01097576 0.05035497 0.02910716]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:25:00 - Best F1 threshold : 0.031764645
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.046218487394957986, 0.20603907637655416, 0.365234375, 0.37104994903160043, 0.7817993700014668, 0.31528793499029645]
04-Mar-25 18:25:00 - Testing Experience 2
04-Mar-25 18:25:00 - Scores: [0.01352215 0.0332102  0.03750725 ... 0.01091985 0.02146218 0.01927794]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:25:00 - Best F1 threshold : 0.011123901
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.03422425032594524, 0.14669106434888685, 0.43470811406192633, 0.8149138234259585, 0.7241107182374156, 0.7966652963930688]
04-Mar-25 18:25:00 - Testing Experience 3
04-Mar-25 18:25:00 - Scores: [0.0121926  0.02362598 0.09057182 ... 0.01064142 0.01684769 0.007166  ]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:25:00 - Best F1 threshold : 0.011525516
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.042477505754341914, 0.15576018808777428, 0.5480776381349, 0.8730112814579115, 0.7719535084468044, 0.8777214966420379]
04-Mar-25 18:25:00 - Testing Experience 4
04-Mar-25 18:25:00 - Scores: [0.01067258 0.01804573 0.09692135 ... 0.01397332 0.01945091 0.01385945]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:25:00 - Best F1 threshold : 0.008354806
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.02023539128639273, 0.10251374705420267, 0.3382827630729503, 0.7510131301669638, 0.6488763495604354, 0.6996552424796318]
04-Mar-25 18:25:00 - Inference Time: 0.136682
04-Mar-25 18:25:00 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:00 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:00 - Train Time Statistics: 0.013000, nan
04-Mar-25 18:25:00 - Inference Time Statistics: 0.136682, nan
04-Mar-25 18:25:00 - Finished experiment 2/3
04-Mar-25 18:25:00 - Loading dataset: UNSW
04-Mar-25 18:25:00 - Normalizing datastream UNSW
04-Mar-25 18:25:00 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:00 - Init normal shape: torch.Size([8393, 36])
04-Mar-25 18:25:00 - Train experience 0 X shape: torch.Size([62554, 36])
04-Mar-25 18:25:00 - Train experience 0 Y shape: torch.Size([62554])
04-Mar-25 18:25:00 - Train experience 1 X shape: torch.Size([15236, 36])
04-Mar-25 18:25:00 - Train experience 1 Y shape: torch.Size([15236])
04-Mar-25 18:25:00 - Train experience 2 X shape: torch.Size([37722, 36])
04-Mar-25 18:25:00 - Train experience 2 Y shape: torch.Size([37722])
04-Mar-25 18:25:00 - Train experience 3 X shape: torch.Size([50155, 36])
04-Mar-25 18:25:00 - Train experience 3 Y shape: torch.Size([50155])
04-Mar-25 18:25:00 - Train experience 4 X shape: torch.Size([33010, 36])
04-Mar-25 18:25:00 - Train experience 4 Y shape: torch.Size([33010])
04-Mar-25 18:25:00 - Test experience 0 X shape: torch.Size([15730, 36])
04-Mar-25 18:25:00 - Test experience 0 Y shape: torch.Size([15730])
04-Mar-25 18:25:00 - Test experience 1 X shape: torch.Size([3829, 36])
04-Mar-25 18:25:00 - Test experience 1 Y shape: torch.Size([3829])
04-Mar-25 18:25:00 - Test experience 2 X shape: torch.Size([9354, 36])
04-Mar-25 18:25:00 - Test experience 2 Y shape: torch.Size([9354])
04-Mar-25 18:25:00 - Test experience 3 X shape: torch.Size([12617, 36])
04-Mar-25 18:25:00 - Test experience 3 Y shape: torch.Size([12617])
04-Mar-25 18:25:00 - Test experience 4 X shape: torch.Size([8140, 36])
04-Mar-25 18:25:00 - Test experience 4 Y shape: torch.Size([8140])
04-Mar-25 18:25:00 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:25:00 - Percetage of normal in experience 0: 0.213719
04-Mar-25 18:25:00 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:25:00 - Percetage of normal in experience 1: 0.877461
04-Mar-25 18:25:00 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:25:00 - Percetage of normal in experience 2: 0.354409
04-Mar-25 18:25:00 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:25:00 - Percetage of normal in experience 3: 0.266554
04-Mar-25 18:25:00 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:25:00 - Percetage of normal in experience 4: 0.404938
04-Mar-25 18:25:00 - Beginning experiment 3/3
04-Mar-25 18:25:00 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:00 - Using PassThroughExtractor
04-Mar-25 18:25:00 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997A2D580>
04-Mar-25 18:25:00 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:00 - X size: torch.Size([62554, 36]), y size: torch.Size([62554])
04-Mar-25 18:25:00 - Fitting feature extractor
04-Mar-25 18:25:00 - Encoding init normal data
04-Mar-25 18:25:00 - Fitting anomaly score method
04-Mar-25 18:25:00 - Fit anomaly score method
04-Mar-25 18:25:00 - Train Time: 0.017513
04-Mar-25 18:25:00 - --------- Testing all experiences ---------
04-Mar-25 18:25:00 - Scores Val Statisitcs: 0.026081, 0.012852
04-Mar-25 18:25:00 - Testing Experience 0
04-Mar-25 18:25:00 - Scores: [0.0483693  0.05072172 0.01116337 ... 0.06411712 0.00865191 0.03155003]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:25:00 - Best F1 threshold : 0.015742637
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.02159654455287154, 0.6456461362522463, 0.8832887759126967, 0.9270797143408608, 0.9264414610204467, 0.9747975114813499]
04-Mar-25 18:25:00 - Testing Experience 1
04-Mar-25 18:25:00 - Scores: [0.00814886 0.00732687 0.04579462 ... 0.01173072 0.01720167 0.02255892]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:25:00 - Best F1 threshold : 0.028300874
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.008565310492505354, 0.20512820512820512, 0.357429718875502, 0.362453531598513, 0.7398264541121684, 0.2937055100362133]
04-Mar-25 18:25:00 - Testing Experience 2
04-Mar-25 18:25:00 - Scores: [0.01123601 0.0299998  0.0143454  ... 0.01797525 0.01370168 0.05761561]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:25:00 - Best F1 threshold : 0.010798967
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.011614401858304297, 0.16953762466001812, 0.40793908375983023, 0.7985850725150336, 0.6737100020046403, 0.7707891181394906]
04-Mar-25 18:25:00 - Testing Experience 3
04-Mar-25 18:25:00 - Scores: [0.01289148 0.01258205 0.03403194 ... 0.00523089 0.02244576 0.01358563]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:25:00 - Best F1 threshold : 0.011148947
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.013517862890247827, 0.16989099479524697, 0.5037267080745341, 0.8622824550285185, 0.7448327888327888, 0.8697576664221641]
04-Mar-25 18:25:00 - Testing Experience 4
04-Mar-25 18:25:00 - Scores: [0.01558471 0.11856928 0.01227968 ... 0.00740016 0.00745337 0.0204697 ]
04-Mar-25 18:25:00 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:25:00 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:25:00 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:25:00 - Best F1 threshold : 0.006307784
04-Mar-25 18:25:00 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:00 - Metric Scores [0.0020881186051367718, 0.09929356357927786, 0.30668198982104744, 0.7434505546377154, 0.6029399159703881, 0.6670464462302762]
04-Mar-25 18:25:00 - Inference Time: 0.111760
04-Mar-25 18:25:00 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:00 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:00 - Train Time Statistics: 0.017513, nan
04-Mar-25 18:25:00 - Inference Time Statistics: 0.111760, nan
04-Mar-25 18:25:00 - Finished experiment 3/3
04-Mar-25 18:25:00 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:25:00 - Loading dataset: XIIoT
04-Mar-25 18:25:01 - Normalizing datastream XIIoT
04-Mar-25 18:25:01 - Loaded XIIoT datastream with: 56 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:01 - Init normal shape: torch.Size([37879, 56])
04-Mar-25 18:25:01 - Train experience 0 X shape: torch.Size([105056, 56])
04-Mar-25 18:25:01 - Train experience 0 Y shape: torch.Size([105056])
04-Mar-25 18:25:01 - Train experience 1 X shape: torch.Size([67340, 56])
04-Mar-25 18:25:01 - Train experience 1 Y shape: torch.Size([67340])
04-Mar-25 18:25:01 - Train experience 2 X shape: torch.Size([217224, 56])
04-Mar-25 18:25:01 - Train experience 2 Y shape: torch.Size([217224])
04-Mar-25 18:25:01 - Train experience 3 X shape: torch.Size([112633, 56])
04-Mar-25 18:25:01 - Train experience 3 Y shape: torch.Size([112633])
04-Mar-25 18:25:01 - Train experience 4 X shape: torch.Size([120743, 56])
04-Mar-25 18:25:01 - Train experience 4 Y shape: torch.Size([120743])
04-Mar-25 18:25:01 - Test experience 0 X shape: torch.Size([26152, 56])
04-Mar-25 18:25:01 - Test experience 0 Y shape: torch.Size([26152])
04-Mar-25 18:25:01 - Test experience 1 X shape: torch.Size([16942, 56])
04-Mar-25 18:25:01 - Test experience 1 Y shape: torch.Size([16942])
04-Mar-25 18:25:01 - Test experience 2 X shape: torch.Size([54066, 56])
04-Mar-25 18:25:01 - Test experience 2 Y shape: torch.Size([54066])
04-Mar-25 18:25:01 - Test experience 3 X shape: torch.Size([28369, 56])
04-Mar-25 18:25:01 - Test experience 3 Y shape: torch.Size([28369])
04-Mar-25 18:25:01 - Test experience 4 X shape: torch.Size([30221, 56])
04-Mar-25 18:25:01 - Test experience 4 Y shape: torch.Size([30221])
04-Mar-25 18:25:01 - Attacks in experience 0: ['BruteForce', 'Fake_notification', 'Modbus_register_reading', 'Normal', 'TCP Relay']
04-Mar-25 18:25:01 - Percetage of normal in experience 0: 0.576883
04-Mar-25 18:25:01 - Attacks in experience 1: ['C&C', 'False_data_injection', 'Normal', 'crypto-ransomware']
04-Mar-25 18:25:01 - Percetage of normal in experience 1: 0.899985
04-Mar-25 18:25:01 - Attacks in experience 2: ['Dictionary', 'Generic_scanning', 'Normal', 'RDOS', 'fuzzing']
04-Mar-25 18:25:01 - Percetage of normal in experience 2: 0.278998
04-Mar-25 18:25:01 - Attacks in experience 3: ['Discovering_resources', 'MQTT_cloud_broker_subscription', 'Normal', 'Reverse_shell', 'insider_malcious']
04-Mar-25 18:25:01 - Percetage of normal in experience 3: 0.538075
04-Mar-25 18:25:01 - Attacks in experience 4: ['Exfiltration', 'MitM', 'Normal', 'Scanning_vulnerability']
04-Mar-25 18:25:01 - Percetage of normal in experience 4: 0.501901
04-Mar-25 18:25:01 - Beginning experiment 1/3
04-Mar-25 18:25:01 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:01 - Using PassThroughExtractor
04-Mar-25 18:25:01 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x000002399123AC90>
04-Mar-25 18:25:01 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:01 - X size: torch.Size([105056, 56]), y size: torch.Size([105056])
04-Mar-25 18:25:01 - Fitting feature extractor
04-Mar-25 18:25:01 - Encoding init normal data
04-Mar-25 18:25:01 - Fitting anomaly score method
04-Mar-25 18:25:01 - Fit anomaly score method
04-Mar-25 18:25:01 - Train Time: 0.083006
04-Mar-25 18:25:01 - --------- Testing all experiences ---------
04-Mar-25 18:25:01 - Scores Val Statisitcs: 0.020794, 0.009808
04-Mar-25 18:25:01 - Testing Experience 0
04-Mar-25 18:25:01 - Scores: [0.0226454  0.01430824 0.01638519 ... 0.03282193 0.03042707 0.02059308]
04-Mar-25 18:25:01 - Trivial percentile value 3std : 0.07537814891338379
04-Mar-25 18:25:01 - Trivial percentile value 2std : 0.03934831991791725
04-Mar-25 18:25:01 - Trivial percentile value 1std : 0.022137145325541497
04-Mar-25 18:25:01 - Best F1 threshold : 0.027322752
04-Mar-25 18:25:01 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:01 - Metric Scores [0.08946356805871046, 0.6561528721077472, 0.773474592897783, 0.8276811079545454, 0.8987704055963309, 0.8653698533912748]
04-Mar-25 18:25:01 - Testing Experience 1
04-Mar-25 18:25:01 - Scores: [0.01703371 0.02347727 0.01797573 ... 0.01436256 0.0170757  0.02878561]
04-Mar-25 18:25:01 - Trivial percentile value 3std : 0.07537814891338379
04-Mar-25 18:25:01 - Trivial percentile value 2std : 0.03934831991791725
04-Mar-25 18:25:01 - Trivial percentile value 1std : 0.022137145325541497
04-Mar-25 18:25:01 - Best F1 threshold : 0.023948964
04-Mar-25 18:25:01 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:01 - Metric Scores [0.055587067498581964, 0.19949585884047533, 0.3293090161828924, 0.3500153515505066, 0.7332080806048011, 0.2369171624881688]
04-Mar-25 18:25:01 - Testing Experience 2
04-Mar-25 18:25:01 - Scores: [0.08567049 0.07223268 0.07900157 ... 0.05605497 0.01288967 0.0582534 ]
04-Mar-25 18:25:01 - Trivial percentile value 3std : 0.07537814891338379
04-Mar-25 18:25:01 - Trivial percentile value 2std : 0.03934831991791725
04-Mar-25 18:25:01 - Trivial percentile value 1std : 0.022137145325541497
04-Mar-25 18:25:01 - Best F1 threshold : 0.047077063
04-Mar-25 18:25:01 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:01 - Metric Scores [0.5955484839170448, 0.9871689801772269, 0.9403506210688954, 0.990004637024061, 0.9922964189210209, 0.9949511672835967]
04-Mar-25 18:25:01 - Testing Experience 3
04-Mar-25 18:25:01 - Scores: [0.01678745 0.02077157 0.01015093 ... 0.04060829 0.03745297 0.01717859]
04-Mar-25 18:25:01 - Trivial percentile value 3std : 0.07537814891338379
04-Mar-25 18:25:01 - Trivial percentile value 2std : 0.03934831991791725
04-Mar-25 18:25:01 - Trivial percentile value 1std : 0.022137145325541497
04-Mar-25 18:25:01 - Best F1 threshold : 0.026562367
04-Mar-25 18:25:01 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:01 - Metric Scores [0.01059722958140943, 0.5614834766393867, 0.6563076112720568, 0.680949770148876, 0.7302252844312376, 0.748431564965303]
04-Mar-25 18:25:01 - Testing Experience 4
04-Mar-25 18:25:01 - Scores: [0.01532721 0.05933831 0.06292085 ... 0.01585102 0.01732972 0.08362482]
04-Mar-25 18:25:01 - Trivial percentile value 3std : 0.07537814891338379
04-Mar-25 18:25:01 - Trivial percentile value 2std : 0.03934831991791725
04-Mar-25 18:25:01 - Trivial percentile value 1std : 0.022137145325541497
04-Mar-25 18:25:01 - Best F1 threshold : 0.02685916
04-Mar-25 18:25:01 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:01 - Metric Scores [0.2158016764758338, 0.789056487609666, 0.853486139794642, 0.8857892379550835, 0.950095619953075, 0.9386942370675666]
04-Mar-25 18:25:01 - Inference Time: 0.275738
04-Mar-25 18:25:01 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:01 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:01 - Train Time Statistics: 0.083006, nan
04-Mar-25 18:25:01 - Inference Time Statistics: 0.275738, nan
04-Mar-25 18:25:01 - Finished experiment 1/3
04-Mar-25 18:25:01 - Loading dataset: XIIoT
04-Mar-25 18:25:02 - Normalizing datastream XIIoT
04-Mar-25 18:25:02 - Loaded XIIoT datastream with: 56 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:02 - Init normal shape: torch.Size([37487, 56])
04-Mar-25 18:25:02 - Train experience 0 X shape: torch.Size([105034, 56])
04-Mar-25 18:25:02 - Train experience 0 Y shape: torch.Size([105034])
04-Mar-25 18:25:02 - Train experience 1 X shape: torch.Size([67500, 56])
04-Mar-25 18:25:02 - Train experience 1 Y shape: torch.Size([67500])
04-Mar-25 18:25:02 - Train experience 2 X shape: torch.Size([217065, 56])
04-Mar-25 18:25:02 - Train experience 2 Y shape: torch.Size([217065])
04-Mar-25 18:25:02 - Train experience 3 X shape: torch.Size([112962, 56])
04-Mar-25 18:25:02 - Train experience 3 Y shape: torch.Size([112962])
04-Mar-25 18:25:02 - Train experience 4 X shape: torch.Size([120783, 56])
04-Mar-25 18:25:02 - Train experience 4 Y shape: torch.Size([120783])
04-Mar-25 18:25:02 - Test experience 0 X shape: torch.Size([26260, 56])
04-Mar-25 18:25:02 - Test experience 0 Y shape: torch.Size([26260])
04-Mar-25 18:25:02 - Test experience 1 X shape: torch.Size([16868, 56])
04-Mar-25 18:25:02 - Test experience 1 Y shape: torch.Size([16868])
04-Mar-25 18:25:02 - Test experience 2 X shape: torch.Size([54311, 56])
04-Mar-25 18:25:02 - Test experience 2 Y shape: torch.Size([54311])
04-Mar-25 18:25:02 - Test experience 3 X shape: torch.Size([28126, 56])
04-Mar-25 18:25:02 - Test experience 3 Y shape: torch.Size([28126])
04-Mar-25 18:25:02 - Test experience 4 X shape: torch.Size([30272, 56])
04-Mar-25 18:25:02 - Test experience 4 Y shape: torch.Size([30272])
04-Mar-25 18:25:02 - Attacks in experience 0: ['BruteForce', 'Fake_notification', 'Modbus_register_reading', 'Normal', 'TCP Relay']
04-Mar-25 18:25:02 - Percetage of normal in experience 0: 0.578489
04-Mar-25 18:25:02 - Attacks in experience 1: ['C&C', 'False_data_injection', 'Normal', 'crypto-ransomware']
04-Mar-25 18:25:02 - Percetage of normal in experience 1: 0.900163
04-Mar-25 18:25:02 - Attacks in experience 2: ['Dictionary', 'Generic_scanning', 'Normal', 'RDOS', 'fuzzing']
04-Mar-25 18:25:02 - Percetage of normal in experience 2: 0.279921
04-Mar-25 18:25:02 - Attacks in experience 3: ['Discovering_resources', 'MQTT_cloud_broker_subscription', 'Normal', 'Reverse_shell', 'insider_malcious']
04-Mar-25 18:25:02 - Percetage of normal in experience 3: 0.537889
04-Mar-25 18:25:02 - Attacks in experience 4: ['Exfiltration', 'MitM', 'Normal', 'Scanning_vulnerability']
04-Mar-25 18:25:02 - Percetage of normal in experience 4: 0.503059
04-Mar-25 18:25:02 - Beginning experiment 2/3
04-Mar-25 18:25:02 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:02 - Using PassThroughExtractor
04-Mar-25 18:25:02 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x000002398FB6D8E0>
04-Mar-25 18:25:02 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:02 - X size: torch.Size([105034, 56]), y size: torch.Size([105034])
04-Mar-25 18:25:02 - Fitting feature extractor
04-Mar-25 18:25:02 - Encoding init normal data
04-Mar-25 18:25:02 - Fitting anomaly score method
04-Mar-25 18:25:02 - Fit anomaly score method
04-Mar-25 18:25:02 - Train Time: 0.075475
04-Mar-25 18:25:02 - --------- Testing all experiences ---------
04-Mar-25 18:25:02 - Scores Val Statisitcs: 0.019490, 0.008919
04-Mar-25 18:25:02 - Testing Experience 0
04-Mar-25 18:25:02 - Scores: [0.01653945 0.03116783 0.06005717 ... 0.01964896 0.01987934 0.00967004]
04-Mar-25 18:25:02 - Trivial percentile value 3std : 0.0655249276012185
04-Mar-25 18:25:02 - Trivial percentile value 2std : 0.03638618066906929
04-Mar-25 18:25:02 - Trivial percentile value 1std : 0.020634007826447486
04-Mar-25 18:25:02 - Best F1 threshold : 0.026279857
04-Mar-25 18:25:02 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:02 - Metric Scores [0.28236744759556104, 0.6575465855992794, 0.7650113474631688, 0.8349232865872422, 0.8920455056377037, 0.8670289265003509]
04-Mar-25 18:25:02 - Testing Experience 1
04-Mar-25 18:25:02 - Scores: [0.0451506  0.02592919 0.02096899 ... 0.01274469 0.01458887 0.01988983]
04-Mar-25 18:25:02 - Trivial percentile value 3std : 0.0655249276012185
04-Mar-25 18:25:02 - Trivial percentile value 2std : 0.03638618066906929
04-Mar-25 18:25:02 - Trivial percentile value 1std : 0.020634007826447486
04-Mar-25 18:25:02 - Best F1 threshold : 0.022834394
04-Mar-25 18:25:02 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:02 - Metric Scores [0.0722495894909688, 0.2148876404494382, 0.3186499565702941, 0.34830263358197594, 0.7318840127199217, 0.2305009359878138]
04-Mar-25 18:25:02 - Testing Experience 2
04-Mar-25 18:25:02 - Scores: [0.08554388 0.05700625 0.01602943 ... 0.08172678 0.0647712  0.02083589]
04-Mar-25 18:25:02 - Trivial percentile value 3std : 0.0655249276012185
04-Mar-25 18:25:02 - Trivial percentile value 2std : 0.03638618066906929
04-Mar-25 18:25:02 - Trivial percentile value 1std : 0.020634007826447486
04-Mar-25 18:25:02 - Best F1 threshold : 0.04724762
04-Mar-25 18:25:02 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:02 - Metric Scores [0.7371829987432733, 0.9854888629560099, 0.9365222514820293, 0.989559342852756, 0.9923084470211543, 0.9951661513248933]
04-Mar-25 18:25:02 - Testing Experience 3
04-Mar-25 18:25:02 - Scores: [0.01337887 0.01316819 0.01485885 ... 0.01862334 0.01529665 0.02765121]
04-Mar-25 18:25:02 - Trivial percentile value 3std : 0.0655249276012185
04-Mar-25 18:25:02 - Trivial percentile value 2std : 0.03638618066906929
04-Mar-25 18:25:02 - Trivial percentile value 1std : 0.020634007826447486
04-Mar-25 18:25:02 - Best F1 threshold : 0.025211858
04-Mar-25 18:25:02 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:02 - Metric Scores [0.08305721228186437, 0.5788063086279766, 0.6514101651747256, 0.6777071151137479, 0.7319499367428902, 0.7447511969551728]
04-Mar-25 18:25:02 - Testing Experience 4
04-Mar-25 18:25:02 - Scores: [0.01387209 0.01509683 0.01837784 ... 0.10396139 0.01493857 0.07097931]
04-Mar-25 18:25:02 - Trivial percentile value 3std : 0.0655249276012185
04-Mar-25 18:25:02 - Trivial percentile value 2std : 0.03638618066906929
04-Mar-25 18:25:02 - Trivial percentile value 1std : 0.020634007826447486
04-Mar-25 18:25:02 - Best F1 threshold : 0.025568876
04-Mar-25 18:25:02 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:02 - Metric Scores [0.40460664703407656, 0.7919230043404416, 0.8432720398693934, 0.8795714695660491, 0.9448912108786298, 0.9351392173960817]
04-Mar-25 18:25:02 - Inference Time: 0.274687
04-Mar-25 18:25:02 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:02 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:02 - Train Time Statistics: 0.075475, nan
04-Mar-25 18:25:02 - Inference Time Statistics: 0.274687, nan
04-Mar-25 18:25:02 - Finished experiment 2/3
04-Mar-25 18:25:02 - Loading dataset: XIIoT
04-Mar-25 18:25:03 - Normalizing datastream XIIoT
04-Mar-25 18:25:03 - Loaded XIIoT datastream with: 56 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:03 - Init normal shape: torch.Size([38002, 56])
04-Mar-25 18:25:03 - Train experience 0 X shape: torch.Size([104926, 56])
04-Mar-25 18:25:03 - Train experience 0 Y shape: torch.Size([104926])
04-Mar-25 18:25:03 - Train experience 1 X shape: torch.Size([67393, 56])
04-Mar-25 18:25:03 - Train experience 1 Y shape: torch.Size([67393])
04-Mar-25 18:25:03 - Train experience 2 X shape: torch.Size([217050, 56])
04-Mar-25 18:25:03 - Train experience 2 Y shape: torch.Size([217050])
04-Mar-25 18:25:03 - Train experience 3 X shape: torch.Size([112848, 56])
04-Mar-25 18:25:03 - Train experience 3 Y shape: torch.Size([112848])
04-Mar-25 18:25:03 - Train experience 4 X shape: torch.Size([120670, 56])
04-Mar-25 18:25:03 - Train experience 4 Y shape: torch.Size([120670])
04-Mar-25 18:25:03 - Test experience 0 X shape: torch.Size([26254, 56])
04-Mar-25 18:25:03 - Test experience 0 Y shape: torch.Size([26254])
04-Mar-25 18:25:03 - Test experience 1 X shape: torch.Size([16861, 56])
04-Mar-25 18:25:03 - Test experience 1 Y shape: torch.Size([16861])
04-Mar-25 18:25:03 - Test experience 2 X shape: torch.Size([54212, 56])
04-Mar-25 18:25:03 - Test experience 2 Y shape: torch.Size([54212])
04-Mar-25 18:25:03 - Test experience 3 X shape: torch.Size([28126, 56])
04-Mar-25 18:25:03 - Test experience 3 Y shape: torch.Size([28126])
04-Mar-25 18:25:03 - Test experience 4 X shape: torch.Size([30269, 56])
04-Mar-25 18:25:03 - Test experience 4 Y shape: torch.Size([30269])
04-Mar-25 18:25:03 - Attacks in experience 0: ['BruteForce', 'Fake_notification', 'Modbus_register_reading', 'Normal', 'TCP Relay']
04-Mar-25 18:25:03 - Percetage of normal in experience 0: 0.578274
04-Mar-25 18:25:03 - Attacks in experience 1: ['C&C', 'False_data_injection', 'Normal', 'crypto-ransomware']
04-Mar-25 18:25:03 - Percetage of normal in experience 1: 0.900331
04-Mar-25 18:25:03 - Attacks in experience 2: ['Dictionary', 'Generic_scanning', 'Normal', 'RDOS', 'fuzzing']
04-Mar-25 18:25:03 - Percetage of normal in experience 2: 0.279548
04-Mar-25 18:25:03 - Attacks in experience 3: ['Discovering_resources', 'MQTT_cloud_broker_subscription', 'Normal', 'Reverse_shell', 'insider_malcious']
04-Mar-25 18:25:03 - Percetage of normal in experience 3: 0.537679
04-Mar-25 18:25:03 - Attacks in experience 4: ['Exfiltration', 'MitM', 'Normal', 'Scanning_vulnerability']
04-Mar-25 18:25:03 - Percetage of normal in experience 4: 0.502818
04-Mar-25 18:25:03 - Beginning experiment 3/3
04-Mar-25 18:25:03 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:03 - Using PassThroughExtractor
04-Mar-25 18:25:03 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997ACEAE0>
04-Mar-25 18:25:03 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:03 - X size: torch.Size([104926, 56]), y size: torch.Size([104926])
04-Mar-25 18:25:03 - Fitting feature extractor
04-Mar-25 18:25:03 - Encoding init normal data
04-Mar-25 18:25:03 - Fitting anomaly score method
04-Mar-25 18:25:03 - Fit anomaly score method
04-Mar-25 18:25:03 - Train Time: 0.076162
04-Mar-25 18:25:03 - --------- Testing all experiences ---------
04-Mar-25 18:25:03 - Scores Val Statisitcs: 0.019045, 0.009761
04-Mar-25 18:25:03 - Testing Experience 0
04-Mar-25 18:25:03 - Scores: [0.01879135 0.01185047 0.02866632 ... 0.01731844 0.0372943  0.00983231]
04-Mar-25 18:25:04 - Trivial percentile value 3std : 0.0721488957405089
04-Mar-25 18:25:04 - Trivial percentile value 2std : 0.03794050626456737
04-Mar-25 18:25:04 - Trivial percentile value 1std : 0.019866670295596123
04-Mar-25 18:25:04 - Best F1 threshold : 0.025704874
04-Mar-25 18:25:04 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:04 - Metric Scores [0.0728625822083766, 0.6408656323352607, 0.7641534746444861, 0.8297046118940617, 0.8890566974036763, 0.8591558963482253]
04-Mar-25 18:25:04 - Testing Experience 1
04-Mar-25 18:25:04 - Scores: [0.00989684 0.02060049 0.02000539 ... 0.01619266 0.01164817 0.02418785]
04-Mar-25 18:25:04 - Trivial percentile value 3std : 0.0721488957405089
04-Mar-25 18:25:04 - Trivial percentile value 2std : 0.03794050626456737
04-Mar-25 18:25:04 - Trivial percentile value 1std : 0.019866670295596123
04-Mar-25 18:25:04 - Best F1 threshold : 0.022395084
04-Mar-25 18:25:04 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:04 - Metric Scores [0.05580357142857143, 0.19072164948453607, 0.3215686274509804, 0.35830931796349663, 0.7288531759357502, 0.23311430826043986]
04-Mar-25 18:25:04 - Testing Experience 2
04-Mar-25 18:25:04 - Scores: [0.08339633 0.02194024 0.08555704 ... 0.07395094 0.0538735  0.07226892]
04-Mar-25 18:25:04 - Trivial percentile value 3std : 0.0721488957405089
04-Mar-25 18:25:04 - Trivial percentile value 2std : 0.03794050626456737
04-Mar-25 18:25:04 - Trivial percentile value 1std : 0.019866670295596123
04-Mar-25 18:25:04 - Best F1 threshold : 0.044832904
04-Mar-25 18:25:04 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:04 - Metric Scores [0.5984650145249794, 0.9875300920913526, 0.9380475443465669, 0.9895235655737705, 0.9909634417877465, 0.9950316219494333]
04-Mar-25 18:25:04 - Testing Experience 3
04-Mar-25 18:25:04 - Scores: [0.02021227 0.03177261 0.00782093 ... 0.00925796 0.04180403 0.02130602]
04-Mar-25 18:25:04 - Trivial percentile value 3std : 0.0721488957405089
04-Mar-25 18:25:04 - Trivial percentile value 2std : 0.03794050626456737
04-Mar-25 18:25:04 - Trivial percentile value 1std : 0.019866670295596123
04-Mar-25 18:25:04 - Best F1 threshold : 0.024216423
04-Mar-25 18:25:04 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:04 - Metric Scores [0.013748854262144821, 0.5281436481909575, 0.6561818044999623, 0.6820043057959391, 0.7361204571665065, 0.7471561773595838]
04-Mar-25 18:25:04 - Testing Experience 4
04-Mar-25 18:25:04 - Scores: [0.01939314 0.02747382 0.06950069 ... 0.0171354  0.01972915 0.01165966]
04-Mar-25 18:25:04 - Trivial percentile value 3std : 0.0721488957405089
04-Mar-25 18:25:04 - Trivial percentile value 2std : 0.03794050626456737
04-Mar-25 18:25:04 - Trivial percentile value 1std : 0.019866670295596123
04-Mar-25 18:25:04 - Best F1 threshold : 0.023556186
04-Mar-25 18:25:04 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:04 - Metric Scores [0.1702487321902922, 0.7565234451638219, 0.8345650276403841, 0.8577505476016635, 0.9275482908303057, 0.9186141742103268]
04-Mar-25 18:25:04 - Inference Time: 0.285181
04-Mar-25 18:25:04 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:04 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:04 - Train Time Statistics: 0.076162, nan
04-Mar-25 18:25:04 - Inference Time Statistics: 0.285181, nan
04-Mar-25 18:25:04 - Finished experiment 3/3
04-Mar-25 18:25:04 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:25:04 - Loading dataset: WUST
04-Mar-25 18:25:05 - Normalizing datastream WUST
04-Mar-25 18:25:05 - Loaded WUST datastream with: 41 input features, 2 output features, 4 experiences,
04-Mar-25 18:25:05 - Init normal shape: torch.Size([99380, 41])
04-Mar-25 18:25:05 - Train experience 0 X shape: torch.Size([199576, 41])
04-Mar-25 18:25:05 - Train experience 0 Y shape: torch.Size([199576])
04-Mar-25 18:25:05 - Train experience 1 X shape: torch.Size([199611, 41])
04-Mar-25 18:25:05 - Train experience 1 Y shape: torch.Size([199611])
04-Mar-25 18:25:05 - Train experience 2 X shape: torch.Size([262021, 41])
04-Mar-25 18:25:05 - Train experience 2 Y shape: torch.Size([262021])
04-Mar-25 18:25:05 - Train experience 3 X shape: torch.Size([206024, 41])
04-Mar-25 18:25:05 - Train experience 3 Y shape: torch.Size([206024])
04-Mar-25 18:25:05 - Test experience 0 X shape: torch.Size([49893, 41])
04-Mar-25 18:25:05 - Test experience 0 Y shape: torch.Size([49893])
04-Mar-25 18:25:05 - Test experience 1 X shape: torch.Size([49905, 41])
04-Mar-25 18:25:05 - Test experience 1 Y shape: torch.Size([49905])
04-Mar-25 18:25:05 - Test experience 2 X shape: torch.Size([65541, 41])
04-Mar-25 18:25:05 - Test experience 2 Y shape: torch.Size([65541])
04-Mar-25 18:25:05 - Test experience 3 X shape: torch.Size([51470, 41])
04-Mar-25 18:25:05 - Test experience 3 Y shape: torch.Size([51470])
04-Mar-25 18:25:05 - Attacks in experience 0: ['Backdoor', 'normal']
04-Mar-25 18:25:05 - Percetage of normal in experience 0: 0.999158
04-Mar-25 18:25:05 - Attacks in experience 1: ['CommInj', 'normal']
04-Mar-25 18:25:05 - Percetage of normal in experience 1: 0.998983
04-Mar-25 18:25:05 - Attacks in experience 2: ['DoS', 'normal']
04-Mar-25 18:25:05 - Percetage of normal in experience 2: 0.761038
04-Mar-25 18:25:05 - Attacks in experience 3: ['Reconn', 'normal']
04-Mar-25 18:25:05 - Percetage of normal in experience 3: 0.967873
04-Mar-25 18:25:05 - Beginning experiment 1/3
04-Mar-25 18:25:05 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:05 - Using PassThroughExtractor
04-Mar-25 18:25:05 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x000002398FB6D8E0>
04-Mar-25 18:25:05 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:05 - X size: torch.Size([199576, 41]), y size: torch.Size([199576])
04-Mar-25 18:25:05 - Fitting feature extractor
04-Mar-25 18:25:05 - Encoding init normal data
04-Mar-25 18:25:05 - Fitting anomaly score method
04-Mar-25 18:25:05 - Fit anomaly score method
04-Mar-25 18:25:05 - Train Time: 0.148619
04-Mar-25 18:25:05 - --------- Testing all experiences ---------
04-Mar-25 18:25:05 - Scores Val Statisitcs: 0.001601, 0.005741
04-Mar-25 18:25:05 - Testing Experience 0
04-Mar-25 18:25:05 - Scores: [0.00065849 0.00056342 0.00036942 ... 0.00050102 0.00118635 0.00046991]
04-Mar-25 18:25:05 - Trivial percentile value 3std : 0.04158033336699009
04-Mar-25 18:25:05 - Trivial percentile value 2std : 0.002617081394419074
04-Mar-25 18:25:05 - Trivial percentile value 1std : 0.0007886974955908955
04-Mar-25 18:25:05 - Best F1 threshold : 0.121031635
04-Mar-25 18:25:05 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:05 - Metric Scores [0.4044943820224719, 0.03645401822700911, 0.0055241682360326425, 0.6493506493506493, 0.9980167378209465, 0.4468888065791423]
04-Mar-25 18:25:05 - Testing Experience 1
04-Mar-25 18:25:05 - Scores: [0.00052704 0.02208946 0.00059177 ... 0.0003609  0.09110396 0.00272582]
04-Mar-25 18:25:05 - Trivial percentile value 3std : 0.04158033336699009
04-Mar-25 18:25:05 - Trivial percentile value 2std : 0.002617081394419074
04-Mar-25 18:25:05 - Trivial percentile value 1std : 0.0007886974955908955
04-Mar-25 18:25:05 - Best F1 threshold : 0.11228644
04-Mar-25 18:25:05 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:05 - Metric Scores [0.411214953271028, 0.04603370324702014, 0.007107049939716987, 0.8037383177570093, 0.9975662214172515, 0.5503176687231012]
04-Mar-25 18:25:05 - Testing Experience 2
04-Mar-25 18:25:05 - Scores: [0.0113755  0.01701749 0.00254239 ... 0.00073984 0.00089193 0.00067826]
04-Mar-25 18:25:05 - Trivial percentile value 3std : 0.04158033336699009
04-Mar-25 18:25:05 - Trivial percentile value 2std : 0.002617081394419074
04-Mar-25 18:25:05 - Trivial percentile value 1std : 0.0007886974955908955
04-Mar-25 18:25:05 - Best F1 threshold : 0.009634103
04-Mar-25 18:25:05 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:05 - Metric Scores [0.6030595101246795, 0.9316076941344099, 0.6678867844222175, 0.966365772227031, 0.9932994968281139, 0.9579880221167876]
04-Mar-25 18:25:05 - Testing Experience 3
04-Mar-25 18:25:05 - Scores: [0.00068245 0.00062869 0.0008035  ... 0.00075488 0.000578   0.00051981]
04-Mar-25 18:25:05 - Trivial percentile value 3std : 0.04158033336699009
04-Mar-25 18:25:05 - Trivial percentile value 2std : 0.002617081394419074
04-Mar-25 18:25:05 - Trivial percentile value 1std : 0.0007886974955908955
04-Mar-25 18:25:05 - Best F1 threshold : 0.023615588
04-Mar-25 18:25:06 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:06 - Metric Scores [0.46770601336302897, 0.5826743350107836, 0.17158886418968985, 0.8566739606126915, 0.9954347137609127, 0.7662676755874072]
04-Mar-25 18:25:06 - Inference Time: 0.385110
04-Mar-25 18:25:06 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:06 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:06 - Train Time Statistics: 0.148619, nan
04-Mar-25 18:25:06 - Inference Time Statistics: 0.385110, nan
04-Mar-25 18:25:06 - Finished experiment 1/3
04-Mar-25 18:25:06 - Loading dataset: WUST
04-Mar-25 18:25:07 - Normalizing datastream WUST
04-Mar-25 18:25:07 - Loaded WUST datastream with: 41 input features, 2 output features, 4 experiences,
04-Mar-25 18:25:07 - Init normal shape: torch.Size([99290, 41])
04-Mar-25 18:25:07 - Train experience 0 X shape: torch.Size([199618, 41])
04-Mar-25 18:25:07 - Train experience 0 Y shape: torch.Size([199618])
04-Mar-25 18:25:07 - Train experience 1 X shape: torch.Size([199648, 41])
04-Mar-25 18:25:07 - Train experience 1 Y shape: torch.Size([199648])
04-Mar-25 18:25:07 - Train experience 2 X shape: torch.Size([261955, 41])
04-Mar-25 18:25:07 - Train experience 2 Y shape: torch.Size([261955])
04-Mar-25 18:25:07 - Train experience 3 X shape: torch.Size([206091, 41])
04-Mar-25 18:25:07 - Train experience 3 Y shape: torch.Size([206091])
04-Mar-25 18:25:07 - Test experience 0 X shape: torch.Size([49876, 41])
04-Mar-25 18:25:07 - Test experience 0 Y shape: torch.Size([49876])
04-Mar-25 18:25:07 - Test experience 1 X shape: torch.Size([49893, 41])
04-Mar-25 18:25:07 - Test experience 1 Y shape: torch.Size([49893])
04-Mar-25 18:25:07 - Test experience 2 X shape: torch.Size([65632, 41])
04-Mar-25 18:25:07 - Test experience 2 Y shape: torch.Size([65632])
04-Mar-25 18:25:07 - Test experience 3 X shape: torch.Size([51428, 41])
04-Mar-25 18:25:07 - Test experience 3 Y shape: torch.Size([51428])
04-Mar-25 18:25:07 - Attacks in experience 0: ['Backdoor', 'normal']
04-Mar-25 18:25:07 - Percetage of normal in experience 0: 0.999133
04-Mar-25 18:25:07 - Attacks in experience 1: ['CommInj', 'normal']
04-Mar-25 18:25:07 - Percetage of normal in experience 1: 0.998983
04-Mar-25 18:25:07 - Attacks in experience 2: ['DoS', 'normal']
04-Mar-25 18:25:07 - Percetage of normal in experience 2: 0.761371
04-Mar-25 18:25:07 - Attacks in experience 3: ['Reconn', 'normal']
04-Mar-25 18:25:07 - Percetage of normal in experience 3: 0.967738
04-Mar-25 18:25:07 - Beginning experiment 2/3
04-Mar-25 18:25:07 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:07 - Using PassThroughExtractor
04-Mar-25 18:25:07 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997B0C470>
04-Mar-25 18:25:07 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:07 - X size: torch.Size([199618, 41]), y size: torch.Size([199618])
04-Mar-25 18:25:07 - Fitting feature extractor
04-Mar-25 18:25:07 - Encoding init normal data
04-Mar-25 18:25:07 - Fitting anomaly score method
04-Mar-25 18:25:07 - Fit anomaly score method
04-Mar-25 18:25:07 - Train Time: 0.142384
04-Mar-25 18:25:07 - --------- Testing all experiences ---------
04-Mar-25 18:25:07 - Scores Val Statisitcs: 0.001363, 0.004439
04-Mar-25 18:25:07 - Testing Experience 0
04-Mar-25 18:25:07 - Scores: [0.00073298 0.00082678 0.00067886 ... 0.00073095 0.00058285 0.00043391]
04-Mar-25 18:25:07 - Trivial percentile value 3std : 0.03034951244294646
04-Mar-25 18:25:07 - Trivial percentile value 2std : 0.0023779972456395627
04-Mar-25 18:25:07 - Trivial percentile value 1std : 0.000699336661491543
04-Mar-25 18:25:07 - Best F1 threshold : 0.10323584
04-Mar-25 18:25:07 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:07 - Metric Scores [0.2537313432835821, 0.03060023538642605, 0.004995836802664446, 0.4594594594594595, 0.9983253097405234, 0.2691609979372634]
04-Mar-25 18:25:07 - Testing Experience 1
04-Mar-25 18:25:07 - Scores: [0.00048101 0.00098333 0.00049977 ... 0.00040352 0.00071086 0.00042269]
04-Mar-25 18:25:07 - Trivial percentile value 3std : 0.03034951244294646
04-Mar-25 18:25:07 - Trivial percentile value 2std : 0.0023779972456395627
04-Mar-25 18:25:07 - Trivial percentile value 1std : 0.000699336661491543
04-Mar-25 18:25:07 - Best F1 threshold : 0.12331418
04-Mar-25 18:25:07 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:07 - Metric Scores [0.3087719298245614, 0.04221635883905013, 0.007095793208312215, 0.803921568627451, 0.9981858716558839, 0.5998269444159174]
04-Mar-25 18:25:07 - Testing Experience 2
04-Mar-25 18:25:07 - Scores: [0.00045209 0.046762   0.00057455 ... 0.00040966 0.05025134 0.00060054]
04-Mar-25 18:25:07 - Trivial percentile value 3std : 0.03034951244294646
04-Mar-25 18:25:07 - Trivial percentile value 2std : 0.0023779972456395627
04-Mar-25 18:25:07 - Trivial percentile value 1std : 0.000699336661491543
04-Mar-25 18:25:07 - Best F1 threshold : 0.008928255
04-Mar-25 18:25:07 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:07 - Metric Scores [0.7902494331065759, 0.9263657957244655, 0.6688828660963835, 0.9659132784670188, 0.9945295172868173, 0.9647468207042598]
04-Mar-25 18:25:07 - Testing Experience 3
04-Mar-25 18:25:07 - Scores: [0.00040085 0.00062789 0.00880311 ... 0.00040959 0.00039725 0.00042855]
04-Mar-25 18:25:07 - Trivial percentile value 3std : 0.03034951244294646
04-Mar-25 18:25:07 - Trivial percentile value 2std : 0.0023779972456395627
04-Mar-25 18:25:07 - Trivial percentile value 1std : 0.000699336661491543
04-Mar-25 18:25:07 - Best F1 threshold : 0.025151
04-Mar-25 18:25:07 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:07 - Metric Scores [0.7679238871899422, 0.5634850363024615, 0.16955293866894017, 0.8359882005899705, 0.9959092158980073, 0.775702650302288]
04-Mar-25 18:25:07 - Inference Time: 0.341301
04-Mar-25 18:25:07 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:07 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:07 - Train Time Statistics: 0.142384, nan
04-Mar-25 18:25:07 - Inference Time Statistics: 0.341301, nan
04-Mar-25 18:25:07 - Finished experiment 2/3
04-Mar-25 18:25:07 - Loading dataset: WUST
04-Mar-25 18:25:08 - Normalizing datastream WUST
04-Mar-25 18:25:08 - Loaded WUST datastream with: 41 input features, 2 output features, 4 experiences,
04-Mar-25 18:25:08 - Init normal shape: torch.Size([100147, 41])
04-Mar-25 18:25:08 - Train experience 0 X shape: torch.Size([199352, 41])
04-Mar-25 18:25:08 - Train experience 0 Y shape: torch.Size([199352])
04-Mar-25 18:25:08 - Train experience 1 X shape: torch.Size([199393, 41])
04-Mar-25 18:25:08 - Train experience 1 Y shape: torch.Size([199393])
04-Mar-25 18:25:08 - Train experience 2 X shape: torch.Size([262019, 41])
04-Mar-25 18:25:08 - Train experience 2 Y shape: torch.Size([262019])
04-Mar-25 18:25:08 - Train experience 3 X shape: torch.Size([205787, 41])
04-Mar-25 18:25:08 - Train experience 3 Y shape: torch.Size([205787])
04-Mar-25 18:25:08 - Test experience 0 X shape: torch.Size([49904, 41])
04-Mar-25 18:25:08 - Test experience 0 Y shape: torch.Size([49904])
04-Mar-25 18:25:08 - Test experience 1 X shape: torch.Size([49910, 41])
04-Mar-25 18:25:08 - Test experience 1 Y shape: torch.Size([49910])
04-Mar-25 18:25:08 - Test experience 2 X shape: torch.Size([65330, 41])
04-Mar-25 18:25:08 - Test experience 2 Y shape: torch.Size([65330])
04-Mar-25 18:25:08 - Test experience 3 X shape: torch.Size([51494, 41])
04-Mar-25 18:25:08 - Test experience 3 Y shape: torch.Size([51494])
04-Mar-25 18:25:08 - Attacks in experience 0: ['Backdoor', 'normal']
04-Mar-25 18:25:08 - Percetage of normal in experience 0: 0.999152
04-Mar-25 18:25:08 - Attacks in experience 1: ['CommInj', 'normal']
04-Mar-25 18:25:08 - Percetage of normal in experience 1: 0.998947
04-Mar-25 18:25:08 - Attacks in experience 2: ['DoS', 'normal']
04-Mar-25 18:25:08 - Percetage of normal in experience 2: 0.760185
04-Mar-25 18:25:08 - Attacks in experience 3: ['Reconn', 'normal']
04-Mar-25 18:25:08 - Percetage of normal in experience 3: 0.967899
04-Mar-25 18:25:08 - Beginning experiment 3/3
04-Mar-25 18:25:08 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:08 - Using PassThroughExtractor
04-Mar-25 18:25:08 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997A48890>
04-Mar-25 18:25:08 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:08 - X size: torch.Size([199352, 41]), y size: torch.Size([199352])
04-Mar-25 18:25:08 - Fitting feature extractor
04-Mar-25 18:25:08 - Encoding init normal data
04-Mar-25 18:25:08 - Fitting anomaly score method
04-Mar-25 18:25:08 - Fit anomaly score method
04-Mar-25 18:25:08 - Train Time: 0.152976
04-Mar-25 18:25:08 - --------- Testing all experiences ---------
04-Mar-25 18:25:08 - Scores Val Statisitcs: 0.001344, 0.004802
04-Mar-25 18:25:08 - Testing Experience 0
04-Mar-25 18:25:08 - Scores: [0.00040065 0.00183398 0.00050806 ... 0.00192724 0.00176133 0.00055897]
04-Mar-25 18:25:08 - Trivial percentile value 3std : 0.04072796942293649
04-Mar-25 18:25:08 - Trivial percentile value 2std : 0.0021523008821532127
04-Mar-25 18:25:08 - Trivial percentile value 1std : 0.0007110272324644029
04-Mar-25 18:25:08 - Best F1 threshold : 0.10804016
04-Mar-25 18:25:08 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:08 - Metric Scores [0.29914529914529914, 0.03422204536410665, 0.005335318568149389, 0.5974025974025974, 0.9983414357028819, 0.3652803271463547]
04-Mar-25 18:25:08 - Testing Experience 1
04-Mar-25 18:25:08 - Scores: [0.00041813 0.00060074 0.00059599 ... 0.00048222 0.0003383  0.00030716]
04-Mar-25 18:25:08 - Trivial percentile value 3std : 0.04072796942293649
04-Mar-25 18:25:08 - Trivial percentile value 2std : 0.0021523008821532127
04-Mar-25 18:25:08 - Trivial percentile value 1std : 0.0007110272324644029
04-Mar-25 18:25:08 - Best F1 threshold : 0.114723295
04-Mar-25 18:25:08 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:08 - Metric Scores [0.3135593220338983, 0.03891977760127085, 0.006076765672474732, 0.782608695652174, 0.9976227790809471, 0.5457654822773333]
04-Mar-25 18:25:08 - Testing Experience 2
04-Mar-25 18:25:08 - Scores: [0.05915342 0.00098494 0.00064349 ... 0.01314067 0.04338907 0.0003054 ]
04-Mar-25 18:25:08 - Trivial percentile value 3std : 0.04072796942293649
04-Mar-25 18:25:08 - Trivial percentile value 2std : 0.0021523008821532127
04-Mar-25 18:25:08 - Trivial percentile value 1std : 0.0007110272324644029
04-Mar-25 18:25:09 - Best F1 threshold : 0.00875883
04-Mar-25 18:25:09 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:09 - Metric Scores [0.6283884551276427, 0.9249304911955515, 0.6602078487441583, 0.9644419447569054, 0.9935263895547004, 0.9594300986214794]
04-Mar-25 18:25:09 - Testing Experience 3
04-Mar-25 18:25:09 - Scores: [0.00034941 0.00178404 0.0018269  ... 0.00042804 0.00036074 0.001673  ]
04-Mar-25 18:25:09 - Trivial percentile value 3std : 0.04072796942293649
04-Mar-25 18:25:09 - Trivial percentile value 2std : 0.0021523008821532127
04-Mar-25 18:25:09 - Trivial percentile value 1std : 0.0007110272324644029
04-Mar-25 18:25:09 - Best F1 threshold : 0.024487754
04-Mar-25 18:25:09 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:09 - Metric Scores [0.5447882736156352, 0.5659854520263249, 0.16934397346875324, 0.8758132956152758, 0.9959068623479893, 0.7690713649605707]
04-Mar-25 18:25:09 - Inference Time: 0.331260
04-Mar-25 18:25:09 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:09 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:09 - Train Time Statistics: 0.152976, nan
04-Mar-25 18:25:09 - Inference Time Statistics: 0.331260, nan
04-Mar-25 18:25:09 - Finished experiment 3/3
04-Mar-25 18:25:09 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:25:09 - Loading dataset: CICIDS17
04-Mar-25 18:25:14 - Normalizing datastream CICIDS17
04-Mar-25 18:25:14 - Loaded CICIDS17 datastream with: 78 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:14 - Init normal shape: torch.Size([204653, 78])
04-Mar-25 18:25:14 - Train experience 0 X shape: torch.Size([458755, 78])
04-Mar-25 18:25:14 - Train experience 0 Y shape: torch.Size([458755])
04-Mar-25 18:25:14 - Train experience 1 X shape: torch.Size([338193, 78])
04-Mar-25 18:25:14 - Train experience 1 Y shape: torch.Size([338193])
04-Mar-25 18:25:14 - Train experience 2 X shape: torch.Size([437483, 78])
04-Mar-25 18:25:14 - Train experience 2 Y shape: torch.Size([437483])
04-Mar-25 18:25:14 - Train experience 3 X shape: torch.Size([335510, 78])
04-Mar-25 18:25:14 - Train experience 3 Y shape: torch.Size([335510])
04-Mar-25 18:25:14 - Train experience 4 X shape: torch.Size([512739, 78])
04-Mar-25 18:25:14 - Train experience 4 Y shape: torch.Size([512739])
04-Mar-25 18:25:14 - Test experience 0 X shape: torch.Size([114816, 78])
04-Mar-25 18:25:14 - Test experience 0 Y shape: torch.Size([114816])
04-Mar-25 18:25:14 - Test experience 1 X shape: torch.Size([84608, 78])
04-Mar-25 18:25:14 - Test experience 1 Y shape: torch.Size([84608])
04-Mar-25 18:25:14 - Test experience 2 X shape: torch.Size([109131, 78])
04-Mar-25 18:25:14 - Test experience 2 Y shape: torch.Size([109131])
04-Mar-25 18:25:14 - Test experience 3 X shape: torch.Size([83957, 78])
04-Mar-25 18:25:14 - Test experience 3 Y shape: torch.Size([83957])
04-Mar-25 18:25:14 - Test experience 4 X shape: torch.Size([128158, 78])
04-Mar-25 18:25:14 - Test experience 4 Y shape: torch.Size([128158])
04-Mar-25 18:25:14 - Attacks in experience 0: ['BENIGN', 'DoS Slowhttptest', 'PortScan']
04-Mar-25 18:25:14 - Percetage of normal in experience 0: 0.713296
04-Mar-25 18:25:14 - Attacks in experience 1: ['BENIGN', 'Bot', 'DoS slowloris', 'SSH-Patator']
04-Mar-25 18:25:14 - Percetage of normal in experience 1: 0.967578
04-Mar-25 18:25:14 - Attacks in experience 2: ['BENIGN', 'DDoS', 'FTP-Patator', 'Web Attack-Brute Force']
04-Mar-25 18:25:14 - Percetage of normal in experience 2: 0.747979
04-Mar-25 18:25:14 - Attacks in experience 3: ['BENIGN', 'DoS GoldenEye', 'Heartbleed', 'Web Attack-Sql Injection']
04-Mar-25 18:25:14 - Percetage of normal in experience 3: 0.975315
04-Mar-25 18:25:14 - Attacks in experience 4: ['BENIGN', 'DoS Hulk', 'Infiltration', 'Web Attack-XSS']
04-Mar-25 18:25:14 - Percetage of normal in experience 4: 0.638188
04-Mar-25 18:25:14 - Beginning experiment 1/3
04-Mar-25 18:25:14 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:14 - Using PassThroughExtractor
04-Mar-25 18:25:14 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997B0E120>
04-Mar-25 18:25:14 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:14 - X size: torch.Size([458755, 78]), y size: torch.Size([458755])
04-Mar-25 18:25:14 - Fitting feature extractor
04-Mar-25 18:25:14 - Encoding init normal data
04-Mar-25 18:25:14 - Fitting anomaly score method
04-Mar-25 18:25:15 - Fit anomaly score method
04-Mar-25 18:25:15 - Train Time: 0.837160
04-Mar-25 18:25:15 - --------- Testing all experiences ---------
04-Mar-25 18:25:15 - Scores Val Statisitcs: 0.011103, 0.018801
04-Mar-25 18:25:15 - Testing Experience 0
04-Mar-25 18:25:15 - Scores: [0.00331093 0.00256999 0.00782897 ... 0.00512328 0.0030339  0.00775943]
04-Mar-25 18:25:15 - Trivial percentile value 3std : 0.10437565091252327
04-Mar-25 18:25:15 - F1 SCORE ZERO, Y = tensor([0, 0, 1,  ..., 0, 0, 1], dtype=torch.int32), Y_pred = [False False False ... False False False]
04-Mar-25 18:25:15 - Trivial percentile value 2std : 0.06119976937770842
04-Mar-25 18:25:15 - Trivial percentile value 1std : 0.007285392973572016
04-Mar-25 18:25:15 - Best F1 threshold : 0.0042172913
04-Mar-25 18:25:15 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:15 - Metric Scores [0.0, 0.0024959144257911156, 0.490037575740769, 0.622708456534595, 0.6867910482571298, 0.3586774204339014]
04-Mar-25 18:25:15 - Testing Experience 1
04-Mar-25 18:25:15 - Scores: [0.00308437 0.02915152 0.00235356 ... 0.00851243 0.00952554 0.00273968]
04-Mar-25 18:25:15 - Trivial percentile value 3std : 0.10437565091252327
04-Mar-25 18:25:15 - Trivial percentile value 2std : 0.06119976937770842
04-Mar-25 18:25:15 - Trivial percentile value 1std : 0.007285392973572016
04-Mar-25 18:25:15 - Best F1 threshold : 0.038090225
04-Mar-25 18:25:15 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:15 - Metric Scores [0.008032128514056224, 0.02218978102189781, 0.05753283339285006, 0.26604532937936876, 0.723989059614354, 0.08601469716948454]
04-Mar-25 18:25:15 - Testing Experience 2
04-Mar-25 18:25:15 - Scores: [0.0021937  0.02525164 0.00287054 ... 0.00553696 0.00561218 0.02321755]
04-Mar-25 18:25:15 - Trivial percentile value 3std : 0.10437565091252327
04-Mar-25 18:25:16 - Trivial percentile value 2std : 0.06119976937770842
04-Mar-25 18:25:16 - Trivial percentile value 1std : 0.007285392973572016
04-Mar-25 18:25:16 - Best F1 threshold : 0.02455355
04-Mar-25 18:25:16 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:16 - Metric Scores [0.005417276720351391, 0.3789167997676782, 0.5553923968020884, 0.676662985302863, 0.83941804504365, 0.6952975872357219]
04-Mar-25 18:25:16 - Testing Experience 3
04-Mar-25 18:25:16 - Scores: [0.00297942 0.02500792 0.00359232 ... 0.00657511 0.0031668  0.04321919]
04-Mar-25 18:25:16 - Trivial percentile value 3std : 0.10437565091252327
04-Mar-25 18:25:16 - Trivial percentile value 2std : 0.06119976937770842
04-Mar-25 18:25:16 - Trivial percentile value 1std : 0.007285392973572016
04-Mar-25 18:25:16 - Best F1 threshold : 0.03039316
04-Mar-25 18:25:16 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:16 - Metric Scores [0.005791505791505791, 0.192243950944647, 0.1571422975989973, 0.40484550561797755, 0.951187814408605, 0.2686651240838317]
04-Mar-25 18:25:16 - Testing Experience 4
04-Mar-25 18:25:16 - Scores: [0.00830487 0.00250138 0.08123544 ... 0.00230775 0.00541878 0.07631552]
04-Mar-25 18:25:16 - Trivial percentile value 3std : 0.10437565091252327
04-Mar-25 18:25:16 - Trivial percentile value 2std : 0.06119976937770842
04-Mar-25 18:25:16 - Trivial percentile value 1std : 0.007285392973572016
04-Mar-25 18:25:16 - Best F1 threshold : 0.02282466
04-Mar-25 18:25:16 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:16 - Metric Scores [0.00259000259000259, 0.6044050768361918, 0.7309411170739917, 0.7803665361612183, 0.9022701027852269, 0.8577994792317595]
04-Mar-25 18:25:16 - Inference Time: 0.887351
04-Mar-25 18:25:16 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:16 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:16 - Train Time Statistics: 0.837160, nan
04-Mar-25 18:25:16 - Inference Time Statistics: 0.887351, nan
04-Mar-25 18:25:16 - Finished experiment 1/3
04-Mar-25 18:25:16 - Loading dataset: CICIDS17
04-Mar-25 18:25:21 - Normalizing datastream CICIDS17
04-Mar-25 18:25:22 - Loaded CICIDS17 datastream with: 78 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:22 - Init normal shape: torch.Size([203771, 78])
04-Mar-25 18:25:22 - Train experience 0 X shape: torch.Size([459020, 78])
04-Mar-25 18:25:22 - Train experience 0 Y shape: torch.Size([459020])
04-Mar-25 18:25:22 - Train experience 1 X shape: torch.Size([338373, 78])
04-Mar-25 18:25:22 - Train experience 1 Y shape: torch.Size([338373])
04-Mar-25 18:25:22 - Train experience 2 X shape: torch.Size([437272, 78])
04-Mar-25 18:25:22 - Train experience 2 Y shape: torch.Size([437272])
04-Mar-25 18:25:22 - Train experience 3 X shape: torch.Size([335740, 78])
04-Mar-25 18:25:22 - Train experience 3 Y shape: torch.Size([335740])
04-Mar-25 18:25:22 - Train experience 4 X shape: torch.Size([513059, 78])
04-Mar-25 18:25:22 - Train experience 4 Y shape: torch.Size([513059])
04-Mar-25 18:25:22 - Test experience 0 X shape: torch.Size([114747, 78])
04-Mar-25 18:25:22 - Test experience 0 Y shape: torch.Size([114747])
04-Mar-25 18:25:22 - Test experience 1 X shape: torch.Size([84624, 78])
04-Mar-25 18:25:22 - Test experience 1 Y shape: torch.Size([84624])
04-Mar-25 18:25:22 - Test experience 2 X shape: torch.Size([109538, 78])
04-Mar-25 18:25:22 - Test experience 2 Y shape: torch.Size([109538])
04-Mar-25 18:25:22 - Test experience 3 X shape: torch.Size([83923, 78])
04-Mar-25 18:25:22 - Test experience 3 Y shape: torch.Size([83923])
04-Mar-25 18:25:22 - Test experience 4 X shape: torch.Size([128034, 78])
04-Mar-25 18:25:22 - Test experience 4 Y shape: torch.Size([128034])
04-Mar-25 18:25:22 - Attacks in experience 0: ['BENIGN', 'DoS Slowhttptest', 'PortScan']
04-Mar-25 18:25:22 - Percetage of normal in experience 0: 0.713289
04-Mar-25 18:25:22 - Attacks in experience 1: ['BENIGN', 'Bot', 'DoS slowloris', 'SSH-Patator']
04-Mar-25 18:25:22 - Percetage of normal in experience 1: 0.967613
04-Mar-25 18:25:22 - Attacks in experience 2: ['BENIGN', 'DDoS', 'FTP-Patator', 'Web Attack-Brute Force']
04-Mar-25 18:25:22 - Percetage of normal in experience 2: 0.748765
04-Mar-25 18:25:22 - Attacks in experience 3: ['BENIGN', 'DoS GoldenEye', 'Heartbleed', 'Web Attack-Sql Injection']
04-Mar-25 18:25:22 - Percetage of normal in experience 3: 0.975201
04-Mar-25 18:25:22 - Attacks in experience 4: ['BENIGN', 'DoS Hulk', 'Infiltration', 'Web Attack-XSS']
04-Mar-25 18:25:22 - Percetage of normal in experience 4: 0.638153
04-Mar-25 18:25:22 - Beginning experiment 2/3
04-Mar-25 18:25:22 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:22 - Using PassThroughExtractor
04-Mar-25 18:25:22 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000023997B0C050>
04-Mar-25 18:25:22 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:22 - X size: torch.Size([459020, 78]), y size: torch.Size([459020])
04-Mar-25 18:25:22 - Fitting feature extractor
04-Mar-25 18:25:22 - Encoding init normal data
04-Mar-25 18:25:22 - Fitting anomaly score method
04-Mar-25 18:25:23 - Fit anomaly score method
04-Mar-25 18:25:23 - Train Time: 0.816301
04-Mar-25 18:25:23 - --------- Testing all experiences ---------
04-Mar-25 18:25:23 - Scores Val Statisitcs: 0.012314, 0.018176
04-Mar-25 18:25:23 - Testing Experience 0
04-Mar-25 18:25:23 - Scores: [0.01374879 0.02279136 0.01770954 ... 0.00285553 0.01000608 0.0017473 ]
04-Mar-25 18:25:23 - Trivial percentile value 3std : 0.09961587487906219
04-Mar-25 18:25:23 - F1 SCORE ZERO, Y = tensor([0, 0, 0,  ..., 0, 0, 0], dtype=torch.int32), Y_pred = [False False False ... False False False]
04-Mar-25 18:25:23 - Trivial percentile value 2std : 0.05869913417845965
04-Mar-25 18:25:23 - Trivial percentile value 1std : 0.009820343963801862
04-Mar-25 18:25:23 - Best F1 threshold : 0.010750998
04-Mar-25 18:25:23 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:23 - Metric Scores [0.0, 0.012308784803384916, 0.7304605174655845, 0.7543328812065987, 0.8313089483186651, 0.4964713542939068]
04-Mar-25 18:25:23 - Testing Experience 1
04-Mar-25 18:25:23 - Scores: [0.00905267 0.00159121 0.00648846 ... 0.00156422 0.00439087 0.01384224]
04-Mar-25 18:25:23 - Trivial percentile value 3std : 0.09961587487906219
04-Mar-25 18:25:23 - Trivial percentile value 2std : 0.05869913417845965
04-Mar-25 18:25:23 - Trivial percentile value 1std : 0.009820343963801862
04-Mar-25 18:25:23 - Best F1 threshold : 0.036971077
04-Mar-25 18:25:23 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:23 - Metric Scores [0.006586169045005488, 0.023295454545454546, 0.13256319748992762, 0.22920734088246777, 0.7513534020691264, 0.08876821982218126]
04-Mar-25 18:25:23 - Testing Experience 2
04-Mar-25 18:25:23 - Scores: [0.00232426 0.00889643 0.08935224 ... 0.00375655 0.00792958 0.00242833]
04-Mar-25 18:25:23 - Trivial percentile value 3std : 0.09961587487906219
04-Mar-25 18:25:23 - Trivial percentile value 2std : 0.05869913417845965
04-Mar-25 18:25:23 - Trivial percentile value 1std : 0.009820343963801862
04-Mar-25 18:25:23 - Best F1 threshold : 0.03751317
04-Mar-25 18:25:23 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:23 - Metric Scores [0.18332950027926537, 0.5626202288144173, 0.5164019636153624, 0.7123281664510754, 0.8299161288824443, 0.7319210078959415]
04-Mar-25 18:25:23 - Testing Experience 3
04-Mar-25 18:25:23 - Scores: [0.00562662 0.02720416 0.02344471 ... 0.00816815 0.01199261 0.01656041]
04-Mar-25 18:25:23 - Trivial percentile value 3std : 0.09961587487906219
04-Mar-25 18:25:23 - Trivial percentile value 2std : 0.05869913417845965
04-Mar-25 18:25:23 - Trivial percentile value 1std : 0.009820343963801862
04-Mar-25 18:25:23 - Best F1 threshold : 0.035135124
04-Mar-25 18:25:23 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:23 - Metric Scores [0.025193798449612403, 0.25594493116395495, 0.13703528038235616, 0.4587259705993215, 0.9391839461305771, 0.2949157301294105]
04-Mar-25 18:25:23 - Testing Experience 4
04-Mar-25 18:25:23 - Scores: [0.01015478 0.00267432 0.00343024 ... 0.00211699 0.00290631 0.01169615]
04-Mar-25 18:25:23 - Trivial percentile value 3std : 0.09961587487906219
04-Mar-25 18:25:24 - Trivial percentile value 2std : 0.05869913417845965
04-Mar-25 18:25:24 - Trivial percentile value 1std : 0.009820343963801862
04-Mar-25 18:25:24 - Best F1 threshold : 0.038834218
04-Mar-25 18:25:24 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:24 - Metric Scores [0.4321247748819192, 0.7546263108987123, 0.673971458141456, 0.7777720896897716, 0.8853776404779832, 0.8663774328764886]
04-Mar-25 18:25:24 - Inference Time: 0.922863
04-Mar-25 18:25:24 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:24 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:24 - Train Time Statistics: 0.816301, nan
04-Mar-25 18:25:24 - Inference Time Statistics: 0.922863, nan
04-Mar-25 18:25:24 - Finished experiment 2/3
04-Mar-25 18:25:24 - Loading dataset: CICIDS17
04-Mar-25 18:25:35 - Normalizing datastream CICIDS17
04-Mar-25 18:25:35 - Loaded CICIDS17 datastream with: 78 input features, 2 output features, 5 experiences,
04-Mar-25 18:25:35 - Init normal shape: torch.Size([205128, 78])
04-Mar-25 18:25:35 - Train experience 0 X shape: torch.Size([458751, 78])
04-Mar-25 18:25:35 - Train experience 0 Y shape: torch.Size([458751])
04-Mar-25 18:25:35 - Train experience 1 X shape: torch.Size([338084, 78])
04-Mar-25 18:25:35 - Train experience 1 Y shape: torch.Size([338084])
04-Mar-25 18:25:35 - Train experience 2 X shape: torch.Size([437117, 78])
04-Mar-25 18:25:35 - Train experience 2 Y shape: torch.Size([437117])
04-Mar-25 18:25:35 - Train experience 3 X shape: torch.Size([335405, 78])
04-Mar-25 18:25:35 - Train experience 3 Y shape: torch.Size([335405])
04-Mar-25 18:25:35 - Train experience 4 X shape: torch.Size([512900, 78])
04-Mar-25 18:25:35 - Train experience 4 Y shape: torch.Size([512900])
04-Mar-25 18:25:35 - Test experience 0 X shape: torch.Size([114714, 78])
04-Mar-25 18:25:35 - Test experience 0 Y shape: torch.Size([114714])
04-Mar-25 18:25:35 - Test experience 1 X shape: torch.Size([84611, 78])
04-Mar-25 18:25:35 - Test experience 1 Y shape: torch.Size([84611])
04-Mar-25 18:25:35 - Test experience 2 X shape: torch.Size([109391, 78])
04-Mar-25 18:25:35 - Test experience 2 Y shape: torch.Size([109391])
04-Mar-25 18:25:35 - Test experience 3 X shape: torch.Size([83956, 78])
04-Mar-25 18:25:35 - Test experience 3 Y shape: torch.Size([83956])
04-Mar-25 18:25:35 - Test experience 4 X shape: torch.Size([127893, 78])
04-Mar-25 18:25:35 - Test experience 4 Y shape: torch.Size([127893])
04-Mar-25 18:25:35 - Attacks in experience 0: ['BENIGN', 'DoS Slowhttptest', 'PortScan']
04-Mar-25 18:25:35 - Percetage of normal in experience 0: 0.713197
04-Mar-25 18:25:35 - Attacks in experience 1: ['BENIGN', 'Bot', 'DoS slowloris', 'SSH-Patator']
04-Mar-25 18:25:35 - Percetage of normal in experience 1: 0.967748
04-Mar-25 18:25:35 - Attacks in experience 2: ['BENIGN', 'DDoS', 'FTP-Patator', 'Web Attack-Brute Force']
04-Mar-25 18:25:35 - Percetage of normal in experience 2: 0.748495
04-Mar-25 18:25:35 - Attacks in experience 3: ['BENIGN', 'DoS GoldenEye', 'Heartbleed', 'Web Attack-Sql Injection']
04-Mar-25 18:25:35 - Percetage of normal in experience 3: 0.975477
04-Mar-25 18:25:35 - Attacks in experience 4: ['BENIGN', 'DoS Hulk', 'Infiltration', 'Web Attack-XSS']
04-Mar-25 18:25:35 - Percetage of normal in experience 4: 0.637902
04-Mar-25 18:25:35 - Beginning experiment 3/3
04-Mar-25 18:25:35 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:25:35 - Using PassThroughExtractor
04-Mar-25 18:25:35 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x00000239979A58E0>
04-Mar-25 18:25:35 - --------- Beginning train experience 0 ----------
04-Mar-25 18:25:35 - X size: torch.Size([458751, 78]), y size: torch.Size([458751])
04-Mar-25 18:25:35 - Fitting feature extractor
04-Mar-25 18:25:35 - Encoding init normal data
04-Mar-25 18:25:35 - Fitting anomaly score method
04-Mar-25 18:25:36 - Fit anomaly score method
04-Mar-25 18:25:36 - Train Time: 0.814564
04-Mar-25 18:25:36 - --------- Testing all experiences ---------
04-Mar-25 18:25:36 - Scores Val Statisitcs: 0.012240, 0.018161
04-Mar-25 18:25:36 - Testing Experience 0
04-Mar-25 18:25:36 - Scores: [0.0043319  0.00297057 0.01593575 ... 0.03225144 0.01498867 0.00420132]
04-Mar-25 18:25:36 - Trivial percentile value 3std : 0.09873482888936995
04-Mar-25 18:25:36 - F1 SCORE ZERO, Y = tensor([1, 0, 1,  ..., 1, 1, 0], dtype=torch.int32), Y_pred = [False False False ... False False False]
04-Mar-25 18:25:36 - Trivial percentile value 2std : 0.0579986304044718
04-Mar-25 18:25:36 - Trivial percentile value 1std : 0.00968004979193211
04-Mar-25 18:25:36 - Best F1 threshold : 0.009901943
04-Mar-25 18:25:36 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:36 - Metric Scores [0.0, 0.014379162001296481, 0.7245777777777778, 0.7319520370745315, 0.8168707142864281, 0.4793871825899143]
04-Mar-25 18:25:36 - Testing Experience 1
04-Mar-25 18:25:36 - Scores: [0.00801265 0.00700596 0.01070841 ... 0.01000093 0.00579584 0.017678  ]
04-Mar-25 18:25:36 - Trivial percentile value 3std : 0.09873482888936995
04-Mar-25 18:25:36 - Trivial percentile value 2std : 0.0579986304044718
04-Mar-25 18:25:36 - Trivial percentile value 1std : 0.00968004979193211
04-Mar-25 18:25:37 - Best F1 threshold : 0.037632354
04-Mar-25 18:25:37 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:37 - Metric Scores [0.012082444918265814, 0.036211699164345405, 0.13316514387017592, 0.23880007894217486, 0.7529267234284385, 0.09407802796138642]
04-Mar-25 18:25:37 - Testing Experience 2
04-Mar-25 18:25:37 - Scores: [0.00538087 0.00706948 0.00457923 ... 0.00732933 0.01447813 0.007336  ]
04-Mar-25 18:25:37 - Trivial percentile value 3std : 0.09873482888936995
04-Mar-25 18:25:37 - Trivial percentile value 2std : 0.0579986304044718
04-Mar-25 18:25:37 - Trivial percentile value 1std : 0.00968004979193211
04-Mar-25 18:25:37 - Best F1 threshold : 0.03975862
04-Mar-25 18:25:37 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:37 - Metric Scores [0.15554440541896639, 0.5622400324642386, 0.510625, 0.7041056892486989, 0.8269369343772153, 0.7232629283713368]
04-Mar-25 18:25:37 - Testing Experience 3
04-Mar-25 18:25:37 - Scores: [0.01407754 0.04431637 0.00761571 ... 0.01965993 0.00732422 0.00763076]
04-Mar-25 18:25:37 - Trivial percentile value 3std : 0.09873482888936995
04-Mar-25 18:25:37 - Trivial percentile value 2std : 0.0579986304044718
04-Mar-25 18:25:37 - Trivial percentile value 1std : 0.00968004979193211
04-Mar-25 18:25:37 - Best F1 threshold : 0.037372462
04-Mar-25 18:25:37 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:37 - Metric Scores [0.022201665124884366, 0.26459143968871596, 0.13663992219790908, 0.4385447394296952, 0.9326915704465915, 0.28636934338767145]
04-Mar-25 18:25:37 - Testing Experience 4
04-Mar-25 18:25:37 - Scores: [0.00370908 0.00452613 0.09804371 ... 0.11776386 0.03614637 0.11710127]
04-Mar-25 18:25:37 - Trivial percentile value 3std : 0.09873482888936995
04-Mar-25 18:25:37 - Trivial percentile value 2std : 0.0579986304044718
04-Mar-25 18:25:37 - Trivial percentile value 1std : 0.00968004979193211
04-Mar-25 18:25:37 - Best F1 threshold : 0.019812707
04-Mar-25 18:25:37 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:25:37 - Metric Scores [0.3135590118938701, 0.7525348753547493, 0.6686005990167084, 0.7762730350610102, 0.8852110796238639, 0.8650902237725323]
04-Mar-25 18:25:37 - Inference Time: 0.910760
04-Mar-25 18:25:37 - --------- Beginning train experience 1 ----------
04-Mar-25 18:25:37 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:25:37 - Train Time Statistics: 0.814564, nan
04-Mar-25 18:25:37 - Inference Time Statistics: 0.910760, nan
04-Mar-25 18:25:37 - Finished experiment 3/3
