04-Mar-25 18:24:12 - Logging initialized with filename: 04-03-2025-06-24-12-feature_extractorNone-anomaly_score_methodRF-datasetUNSW_XIIoT_WUST_CICIDS17-num_experiments3-train_epochs10-normalizeTrue-batch_size64-memory_modeNone
04-Mar-25 18:24:14 - Note: NumExpr detected 28 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
04-Mar-25 18:24:15 - Using Device: cuda
04-Mar-25 18:24:15 - Beginning experiment with settings: {'feature_extractor': [None], 'anomaly_score_method': ['RF'], 'metrics': ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc'], 'dataset': ['UNSW', 'XIIoT', 'WUST', 'CICIDS17'], 'num_experiments': 3, 'train_epochs': 10, 'normalize': True, 'batch_size': 64, 'memory_mode': [None]}
04-Mar-25 18:24:15 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:24:15 - Loading dataset: UNSW
04-Mar-25 18:24:15 - Normalizing datastream UNSW
04-Mar-25 18:24:15 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:15 - Init normal shape: torch.Size([8312, 36])
04-Mar-25 18:24:15 - Train experience 0 X shape: torch.Size([62659, 36])
04-Mar-25 18:24:15 - Train experience 0 Y shape: torch.Size([62659])
04-Mar-25 18:24:15 - Train experience 1 X shape: torch.Size([15241, 36])
04-Mar-25 18:24:15 - Train experience 1 Y shape: torch.Size([15241])
04-Mar-25 18:24:15 - Train experience 2 X shape: torch.Size([37652, 36])
04-Mar-25 18:24:15 - Train experience 2 Y shape: torch.Size([37652])
04-Mar-25 18:24:15 - Train experience 3 X shape: torch.Size([50226, 36])
04-Mar-25 18:24:15 - Train experience 3 Y shape: torch.Size([50226])
04-Mar-25 18:24:15 - Train experience 4 X shape: torch.Size([32971, 36])
04-Mar-25 18:24:15 - Train experience 4 Y shape: torch.Size([32971])
04-Mar-25 18:24:15 - Test experience 0 X shape: torch.Size([15643, 36])
04-Mar-25 18:24:15 - Test experience 0 Y shape: torch.Size([15643])
04-Mar-25 18:24:15 - Test experience 1 X shape: torch.Size([3842, 36])
04-Mar-25 18:24:15 - Test experience 1 Y shape: torch.Size([3842])
04-Mar-25 18:24:15 - Test experience 2 X shape: torch.Size([9442, 36])
04-Mar-25 18:24:15 - Test experience 2 Y shape: torch.Size([9442])
04-Mar-25 18:24:15 - Test experience 3 X shape: torch.Size([12564, 36])
04-Mar-25 18:24:15 - Test experience 3 Y shape: torch.Size([12564])
04-Mar-25 18:24:15 - Test experience 4 X shape: torch.Size([8197, 36])
04-Mar-25 18:24:15 - Test experience 4 Y shape: torch.Size([8197])
04-Mar-25 18:24:15 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:15 - Percetage of normal in experience 0: 0.213792
04-Mar-25 18:24:15 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:15 - Percetage of normal in experience 1: 0.878945
04-Mar-25 18:24:15 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:15 - Percetage of normal in experience 2: 0.355785
04-Mar-25 18:24:15 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:15 - Percetage of normal in experience 3: 0.266714
04-Mar-25 18:24:15 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:15 - Percetage of normal in experience 4: 0.406236
04-Mar-25 18:24:15 - Beginning experiment 1/3
04-Mar-25 18:24:15 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:15 - Using PassThroughExtractor
04-Mar-25 18:24:15 - Traceback (most recent call last):
  File "<ipython-input-1-a243036c61d4>", line 67, in <module>
    main.run_experiments(experiment, device)
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 50, in run_experiments
    df = run_single_experiment(config, datastream, device)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 200, in run_single_experiment
    raise ValueError(f"Anomaly score method {a_s_m} is invalid")
ValueError: Anomaly score method RF is invalid

04-Mar-25 18:24:31 - Logging initialized with filename: 04-03-2025-06-24-31-feature_extractorNone-anomaly_score_methodPCA-datasetUNSW_XIIoT_WUST_CICIDS17-num_experiments3-train_epochs10-normalizeTrue-batch_size64-memory_modeNone
04-Mar-25 18:24:31 - Using Device: cuda
04-Mar-25 18:24:31 - Beginning experiment with settings: {'feature_extractor': [None], 'anomaly_score_method': ['PCA'], 'metrics': ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc'], 'dataset': ['UNSW', 'XIIoT', 'WUST', 'CICIDS17'], 'num_experiments': 3, 'train_epochs': 10, 'normalize': True, 'batch_size': 64, 'memory_mode': [None]}
04-Mar-25 18:24:31 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:24:31 - Loading dataset: UNSW
04-Mar-25 18:24:31 - Normalizing datastream UNSW
04-Mar-25 18:24:31 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:31 - Init normal shape: torch.Size([8312, 36])
04-Mar-25 18:24:31 - Train experience 0 X shape: torch.Size([62659, 36])
04-Mar-25 18:24:31 - Train experience 0 Y shape: torch.Size([62659])
04-Mar-25 18:24:31 - Train experience 1 X shape: torch.Size([15241, 36])
04-Mar-25 18:24:31 - Train experience 1 Y shape: torch.Size([15241])
04-Mar-25 18:24:31 - Train experience 2 X shape: torch.Size([37652, 36])
04-Mar-25 18:24:31 - Train experience 2 Y shape: torch.Size([37652])
04-Mar-25 18:24:31 - Train experience 3 X shape: torch.Size([50226, 36])
04-Mar-25 18:24:31 - Train experience 3 Y shape: torch.Size([50226])
04-Mar-25 18:24:31 - Train experience 4 X shape: torch.Size([32971, 36])
04-Mar-25 18:24:31 - Train experience 4 Y shape: torch.Size([32971])
04-Mar-25 18:24:31 - Test experience 0 X shape: torch.Size([15643, 36])
04-Mar-25 18:24:31 - Test experience 0 Y shape: torch.Size([15643])
04-Mar-25 18:24:31 - Test experience 1 X shape: torch.Size([3842, 36])
04-Mar-25 18:24:31 - Test experience 1 Y shape: torch.Size([3842])
04-Mar-25 18:24:31 - Test experience 2 X shape: torch.Size([9442, 36])
04-Mar-25 18:24:31 - Test experience 2 Y shape: torch.Size([9442])
04-Mar-25 18:24:31 - Test experience 3 X shape: torch.Size([12564, 36])
04-Mar-25 18:24:31 - Test experience 3 Y shape: torch.Size([12564])
04-Mar-25 18:24:31 - Test experience 4 X shape: torch.Size([8197, 36])
04-Mar-25 18:24:31 - Test experience 4 Y shape: torch.Size([8197])
04-Mar-25 18:24:31 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:31 - Percetage of normal in experience 0: 0.213792
04-Mar-25 18:24:31 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:31 - Percetage of normal in experience 1: 0.878945
04-Mar-25 18:24:31 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:31 - Percetage of normal in experience 2: 0.355785
04-Mar-25 18:24:31 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:31 - Percetage of normal in experience 3: 0.266714
04-Mar-25 18:24:31 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:31 - Percetage of normal in experience 4: 0.406236
04-Mar-25 18:24:31 - Beginning experiment 1/3
04-Mar-25 18:24:31 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:31 - Using PassThroughExtractor
04-Mar-25 18:24:31 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x000002260F5C2B70>
04-Mar-25 18:24:31 - --------- Beginning train experience 0 ----------
04-Mar-25 18:24:31 - X size: torch.Size([62659, 36]), y size: torch.Size([62659])
04-Mar-25 18:24:31 - Fitting feature extractor
04-Mar-25 18:24:31 - Encoding init normal data
04-Mar-25 18:24:31 - Fitting anomaly score method
04-Mar-25 18:24:32 - Fit anomaly score method
04-Mar-25 18:24:32 - Train Time: 0.066953
04-Mar-25 18:24:32 - --------- Testing all experiences ---------
04-Mar-25 18:24:32 - Scores Val Statisitcs: 0.026514, 0.013202
04-Mar-25 18:24:32 - Testing Experience 0
04-Mar-25 18:24:32 - Scores: [0.03834681 0.05424976 0.05383261 ... 0.06668872 0.08560976 0.03266874]
04-Mar-25 18:24:32 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:32 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:32 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:32 - Best F1 threshold : 0.016748667
04-Mar-25 18:24:32 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:32 - Metric Scores [0.2368119266055046, 0.5278836987607245, 0.891612509268548, 0.9331881465349615, 0.928773001643758, 0.973383600448825]
04-Mar-25 18:24:32 - Testing Experience 1
04-Mar-25 18:24:32 - Scores: [0.04076855 0.02291305 0.00771509 ... 0.01638828 0.00904685 0.01523162]
04-Mar-25 18:24:32 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:32 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:32 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:32 - Best F1 threshold : 0.03303366
04-Mar-25 18:24:32 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:32 - Metric Scores [0.06201550387596899, 0.2049586776859504, 0.35563380281690143, 0.3691073219658977, 0.7423637397309495, 0.3100029387629634]
04-Mar-25 18:24:32 - Testing Experience 2
04-Mar-25 18:24:32 - Scores: [0.00748155 0.01621025 0.01119728 ... 0.04391637 0.01102111 0.0244633 ]
04-Mar-25 18:24:32 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:32 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:32 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:32 - Best F1 threshold : 0.011582003
04-Mar-25 18:24:32 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:32 - Metric Scores [0.03859141341051616, 0.1492087415222306, 0.4368421052631579, 0.8073212258796821, 0.6841917150365403, 0.779688762834818]
04-Mar-25 18:24:32 - Testing Experience 3
04-Mar-25 18:24:32 - Scores: [0.00613217 0.03458637 0.01667811 ... 0.02460381 0.02313542 0.016961  ]
04-Mar-25 18:24:32 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:32 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:32 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:32 - Best F1 threshold : 0.010414476
04-Mar-25 18:24:32 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:32 - Metric Scores [0.047018955840304986, 0.16374269005847952, 0.5907099035933392, 0.8674396135265701, 0.7753426727810551, 0.8864928346861237]
04-Mar-25 18:24:32 - Testing Experience 4
04-Mar-25 18:24:32 - Scores: [0.01533421 0.05139586 0.0151626  ... 0.01088534 0.02339488 0.01940325]
04-Mar-25 18:24:32 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:32 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:32 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:32 - Best F1 threshold : 0.007748012
04-Mar-25 18:24:32 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:32 - Metric Scores [0.024791709002235318, 0.09811173836869769, 0.33839822728711616, 0.7500998322817667, 0.6245798760876865, 0.6905021231255926]
04-Mar-25 18:24:32 - Inference Time: 0.152597
04-Mar-25 18:24:32 - --------- Beginning train experience 1 ----------
04-Mar-25 18:24:32 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:24:32 - Train Time Statistics: 0.066953, nan
04-Mar-25 18:24:32 - Inference Time Statistics: 0.152597, nan
04-Mar-25 18:24:32 - Traceback (most recent call last):
  File "<ipython-input-2-1eddd84d188e>", line 67, in <module>
    main.run_experiments(experiment, device)
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 50, in run_experiments
    df = run_single_experiment(config, datastream, device)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 206, in run_single_experiment
    df = fit_and_test(f_e, a_s_m,datastream, config, df, device)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 349, in fit_and_test
    train_time_df.to_csv(f"time_results/train_time_{config['feature_extractor']}_{config['anomaly_score_method']}_{config['dataset']}.csv")
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\common.py", line 749, in get_handle
    check_parent_directory(str(handle))
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\common.py", line 616, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: 'time_results'

04-Mar-25 18:24:47 - Logging initialized with filename: 04-03-2025-06-24-47-feature_extractorNone-anomaly_score_methodPCA-datasetUNSW_XIIoT_WUST_CICIDS17-num_experiments3-train_epochs10-normalizeTrue-batch_size64-memory_modeNone
04-Mar-25 18:24:47 - Using Device: cuda
04-Mar-25 18:24:47 - Beginning experiment with settings: {'feature_extractor': [None], 'anomaly_score_method': ['PCA'], 'metrics': ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc'], 'dataset': ['UNSW', 'XIIoT', 'WUST', 'CICIDS17'], 'num_experiments': 3, 'train_epochs': 10, 'normalize': True, 'batch_size': 64, 'memory_mode': [None]}
04-Mar-25 18:24:47 - Created results df with columns: ['Experiment Number', 'Train Experience', 'Test Experience']
04-Mar-25 18:24:47 - Loading dataset: UNSW
04-Mar-25 18:24:47 - Normalizing datastream UNSW
04-Mar-25 18:24:47 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:47 - Init normal shape: torch.Size([8312, 36])
04-Mar-25 18:24:47 - Train experience 0 X shape: torch.Size([62659, 36])
04-Mar-25 18:24:47 - Train experience 0 Y shape: torch.Size([62659])
04-Mar-25 18:24:47 - Train experience 1 X shape: torch.Size([15241, 36])
04-Mar-25 18:24:47 - Train experience 1 Y shape: torch.Size([15241])
04-Mar-25 18:24:47 - Train experience 2 X shape: torch.Size([37652, 36])
04-Mar-25 18:24:47 - Train experience 2 Y shape: torch.Size([37652])
04-Mar-25 18:24:47 - Train experience 3 X shape: torch.Size([50226, 36])
04-Mar-25 18:24:47 - Train experience 3 Y shape: torch.Size([50226])
04-Mar-25 18:24:47 - Train experience 4 X shape: torch.Size([32971, 36])
04-Mar-25 18:24:47 - Train experience 4 Y shape: torch.Size([32971])
04-Mar-25 18:24:47 - Test experience 0 X shape: torch.Size([15643, 36])
04-Mar-25 18:24:47 - Test experience 0 Y shape: torch.Size([15643])
04-Mar-25 18:24:47 - Test experience 1 X shape: torch.Size([3842, 36])
04-Mar-25 18:24:47 - Test experience 1 Y shape: torch.Size([3842])
04-Mar-25 18:24:47 - Test experience 2 X shape: torch.Size([9442, 36])
04-Mar-25 18:24:47 - Test experience 2 Y shape: torch.Size([9442])
04-Mar-25 18:24:47 - Test experience 3 X shape: torch.Size([12564, 36])
04-Mar-25 18:24:47 - Test experience 3 Y shape: torch.Size([12564])
04-Mar-25 18:24:47 - Test experience 4 X shape: torch.Size([8197, 36])
04-Mar-25 18:24:47 - Test experience 4 Y shape: torch.Size([8197])
04-Mar-25 18:24:47 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:47 - Percetage of normal in experience 0: 0.213792
04-Mar-25 18:24:47 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:47 - Percetage of normal in experience 1: 0.878945
04-Mar-25 18:24:47 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:47 - Percetage of normal in experience 2: 0.355785
04-Mar-25 18:24:47 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:47 - Percetage of normal in experience 3: 0.266714
04-Mar-25 18:24:47 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:47 - Percetage of normal in experience 4: 0.406236
04-Mar-25 18:24:47 - Beginning experiment 1/3
04-Mar-25 18:24:47 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:47 - Using PassThroughExtractor
04-Mar-25 18:24:47 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000022617A8FE90>
04-Mar-25 18:24:47 - --------- Beginning train experience 0 ----------
04-Mar-25 18:24:47 - X size: torch.Size([62659, 36]), y size: torch.Size([62659])
04-Mar-25 18:24:47 - Fitting feature extractor
04-Mar-25 18:24:47 - Encoding init normal data
04-Mar-25 18:24:47 - Fitting anomaly score method
04-Mar-25 18:24:47 - Fit anomaly score method
04-Mar-25 18:24:47 - Train Time: 0.012000
04-Mar-25 18:24:47 - --------- Testing all experiences ---------
04-Mar-25 18:24:47 - Scores Val Statisitcs: 0.026514, 0.013202
04-Mar-25 18:24:47 - Testing Experience 0
04-Mar-25 18:24:47 - Scores: [0.03834681 0.05424976 0.05383261 ... 0.06668872 0.08560976 0.03266874]
04-Mar-25 18:24:47 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:47 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:47 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:47 - Best F1 threshold : 0.016748667
04-Mar-25 18:24:47 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:47 - Metric Scores [0.2368119266055046, 0.5278836987607245, 0.891612509268548, 0.9331881465349615, 0.928773001643758, 0.973383600448825]
04-Mar-25 18:24:47 - Testing Experience 1
04-Mar-25 18:24:47 - Scores: [0.04076855 0.02291305 0.00771509 ... 0.01638828 0.00904685 0.01523162]
04-Mar-25 18:24:47 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:47 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:47 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:47 - Best F1 threshold : 0.03303366
04-Mar-25 18:24:47 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:47 - Metric Scores [0.06201550387596899, 0.2049586776859504, 0.35563380281690143, 0.3691073219658977, 0.7423637397309495, 0.3100029387629634]
04-Mar-25 18:24:47 - Testing Experience 2
04-Mar-25 18:24:47 - Scores: [0.00748155 0.01621025 0.01119728 ... 0.04391637 0.01102111 0.0244633 ]
04-Mar-25 18:24:47 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:47 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:47 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:47 - Best F1 threshold : 0.011582003
04-Mar-25 18:24:47 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:47 - Metric Scores [0.03859141341051616, 0.1492087415222306, 0.4368421052631579, 0.8073212258796821, 0.6841917150365403, 0.779688762834818]
04-Mar-25 18:24:47 - Testing Experience 3
04-Mar-25 18:24:47 - Scores: [0.00613217 0.03458637 0.01667811 ... 0.02460381 0.02313542 0.016961  ]
04-Mar-25 18:24:47 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:47 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:47 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:47 - Best F1 threshold : 0.010414476
04-Mar-25 18:24:47 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:47 - Metric Scores [0.047018955840304986, 0.16374269005847952, 0.5907099035933392, 0.8674396135265701, 0.7753426727810551, 0.8864928346861237]
04-Mar-25 18:24:47 - Testing Experience 4
04-Mar-25 18:24:47 - Scores: [0.01533421 0.05139586 0.0151626  ... 0.01088534 0.02339488 0.01940325]
04-Mar-25 18:24:47 - Trivial percentile value 3std : 0.08018175326287745
04-Mar-25 18:24:47 - Trivial percentile value 2std : 0.05500240642577408
04-Mar-25 18:24:47 - Trivial percentile value 1std : 0.028724991381168366
04-Mar-25 18:24:47 - Best F1 threshold : 0.007748012
04-Mar-25 18:24:47 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:47 - Metric Scores [0.024791709002235318, 0.09811173836869769, 0.33839822728711616, 0.7500998322817667, 0.6245798760876865, 0.6905021231255926]
04-Mar-25 18:24:47 - Inference Time: 0.159203
04-Mar-25 18:24:47 - --------- Beginning train experience 1 ----------
04-Mar-25 18:24:47 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:24:47 - Train Time Statistics: 0.012000, nan
04-Mar-25 18:24:47 - Inference Time Statistics: 0.159203, nan
04-Mar-25 18:24:47 - Finished experiment 1/3
04-Mar-25 18:24:47 - Loading dataset: UNSW
04-Mar-25 18:24:48 - Normalizing datastream UNSW
04-Mar-25 18:24:48 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:48 - Init normal shape: torch.Size([8289, 36])
04-Mar-25 18:24:48 - Train experience 0 X shape: torch.Size([62678, 36])
04-Mar-25 18:24:48 - Train experience 0 Y shape: torch.Size([62678])
04-Mar-25 18:24:48 - Train experience 1 X shape: torch.Size([15266, 36])
04-Mar-25 18:24:48 - Train experience 1 Y shape: torch.Size([15266])
04-Mar-25 18:24:48 - Train experience 2 X shape: torch.Size([37711, 36])
04-Mar-25 18:24:48 - Train experience 2 Y shape: torch.Size([37711])
04-Mar-25 18:24:48 - Train experience 3 X shape: torch.Size([50091, 36])
04-Mar-25 18:24:48 - Train experience 3 Y shape: torch.Size([50091])
04-Mar-25 18:24:48 - Train experience 4 X shape: torch.Size([33023, 36])
04-Mar-25 18:24:48 - Train experience 4 Y shape: torch.Size([33023])
04-Mar-25 18:24:48 - Test experience 0 X shape: torch.Size([15629, 36])
04-Mar-25 18:24:48 - Test experience 0 Y shape: torch.Size([15629])
04-Mar-25 18:24:48 - Test experience 1 X shape: torch.Size([3822, 36])
04-Mar-25 18:24:48 - Test experience 1 Y shape: torch.Size([3822])
04-Mar-25 18:24:48 - Test experience 2 X shape: torch.Size([9388, 36])
04-Mar-25 18:24:48 - Test experience 2 Y shape: torch.Size([9388])
04-Mar-25 18:24:48 - Test experience 3 X shape: torch.Size([12704, 36])
04-Mar-25 18:24:48 - Test experience 3 Y shape: torch.Size([12704])
04-Mar-25 18:24:48 - Test experience 4 X shape: torch.Size([8150, 36])
04-Mar-25 18:24:48 - Test experience 4 Y shape: torch.Size([8150])
04-Mar-25 18:24:48 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:48 - Percetage of normal in experience 0: 0.213600
04-Mar-25 18:24:48 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:48 - Percetage of normal in experience 1: 0.876982
04-Mar-25 18:24:48 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:48 - Percetage of normal in experience 2: 0.355016
04-Mar-25 18:24:48 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:48 - Percetage of normal in experience 3: 0.267274
04-Mar-25 18:24:48 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:48 - Percetage of normal in experience 4: 0.405293
04-Mar-25 18:24:48 - Beginning experiment 2/3
04-Mar-25 18:24:48 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:48 - Using PassThroughExtractor
04-Mar-25 18:24:48 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000022617A8FE90>
04-Mar-25 18:24:48 - --------- Beginning train experience 0 ----------
04-Mar-25 18:24:48 - X size: torch.Size([62678, 36]), y size: torch.Size([62678])
04-Mar-25 18:24:48 - Fitting feature extractor
04-Mar-25 18:24:48 - Encoding init normal data
04-Mar-25 18:24:48 - Fitting anomaly score method
04-Mar-25 18:24:48 - Fit anomaly score method
04-Mar-25 18:24:48 - Train Time: 0.014507
04-Mar-25 18:24:48 - --------- Testing all experiences ---------
04-Mar-25 18:24:48 - Scores Val Statisitcs: 0.026660, 0.012832
04-Mar-25 18:24:48 - Testing Experience 0
04-Mar-25 18:24:48 - Scores: [0.04342672 0.06502935 0.05436363 ... 0.07610385 0.02060528 0.00527574]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:24:48 - Best F1 threshold : 0.017714892
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.15833708539696834, 0.44088404787537205, 0.8899030233884769, 0.9383386455750994, 0.9333168093349846, 0.9736770843393594]
04-Mar-25 18:24:48 - Testing Experience 1
04-Mar-25 18:24:48 - Scores: [0.02779378 0.02097827 0.01103358 ... 0.01097576 0.05035497 0.02910716]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:24:48 - Best F1 threshold : 0.031764645
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.046218487394957986, 0.20603907637655416, 0.365234375, 0.37104994903160043, 0.7817993700014668, 0.31528793499029645]
04-Mar-25 18:24:48 - Testing Experience 2
04-Mar-25 18:24:48 - Scores: [0.01352215 0.0332102  0.03750725 ... 0.01091985 0.02146218 0.01927794]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:24:48 - Best F1 threshold : 0.011123901
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.03422425032594524, 0.14669106434888685, 0.43470811406192633, 0.8149138234259585, 0.7241107182374156, 0.7966652963930688]
04-Mar-25 18:24:48 - Testing Experience 3
04-Mar-25 18:24:48 - Scores: [0.0121926  0.02362598 0.09057182 ... 0.01064142 0.01684769 0.007166  ]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:24:48 - Best F1 threshold : 0.011525516
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.042477505754341914, 0.15576018808777428, 0.5480776381349, 0.8730112814579115, 0.7719535084468044, 0.8777214966420379]
04-Mar-25 18:24:48 - Testing Experience 4
04-Mar-25 18:24:48 - Scores: [0.01067258 0.01804573 0.09692135 ... 0.01397332 0.01945091 0.01385945]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.08199747212976183
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.056227436475455764
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.030166116654872895
04-Mar-25 18:24:48 - Best F1 threshold : 0.008354806
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.02023539128639273, 0.10251374705420267, 0.3382827630729503, 0.7510131301669638, 0.6488763495604354, 0.6996552424796318]
04-Mar-25 18:24:48 - Inference Time: 0.150265
04-Mar-25 18:24:48 - --------- Beginning train experience 1 ----------
04-Mar-25 18:24:48 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:24:48 - Train Time Statistics: 0.014507, nan
04-Mar-25 18:24:48 - Inference Time Statistics: 0.150265, nan
04-Mar-25 18:24:48 - Finished experiment 2/3
04-Mar-25 18:24:48 - Loading dataset: UNSW
04-Mar-25 18:24:48 - Normalizing datastream UNSW
04-Mar-25 18:24:48 - Loaded UNSW datastream with: 36 input features, 2 output features, 5 experiences,
04-Mar-25 18:24:48 - Init normal shape: torch.Size([8393, 36])
04-Mar-25 18:24:48 - Train experience 0 X shape: torch.Size([62554, 36])
04-Mar-25 18:24:48 - Train experience 0 Y shape: torch.Size([62554])
04-Mar-25 18:24:48 - Train experience 1 X shape: torch.Size([15236, 36])
04-Mar-25 18:24:48 - Train experience 1 Y shape: torch.Size([15236])
04-Mar-25 18:24:48 - Train experience 2 X shape: torch.Size([37722, 36])
04-Mar-25 18:24:48 - Train experience 2 Y shape: torch.Size([37722])
04-Mar-25 18:24:48 - Train experience 3 X shape: torch.Size([50155, 36])
04-Mar-25 18:24:48 - Train experience 3 Y shape: torch.Size([50155])
04-Mar-25 18:24:48 - Train experience 4 X shape: torch.Size([33010, 36])
04-Mar-25 18:24:48 - Train experience 4 Y shape: torch.Size([33010])
04-Mar-25 18:24:48 - Test experience 0 X shape: torch.Size([15730, 36])
04-Mar-25 18:24:48 - Test experience 0 Y shape: torch.Size([15730])
04-Mar-25 18:24:48 - Test experience 1 X shape: torch.Size([3829, 36])
04-Mar-25 18:24:48 - Test experience 1 Y shape: torch.Size([3829])
04-Mar-25 18:24:48 - Test experience 2 X shape: torch.Size([9354, 36])
04-Mar-25 18:24:48 - Test experience 2 Y shape: torch.Size([9354])
04-Mar-25 18:24:48 - Test experience 3 X shape: torch.Size([12617, 36])
04-Mar-25 18:24:48 - Test experience 3 Y shape: torch.Size([12617])
04-Mar-25 18:24:48 - Test experience 4 X shape: torch.Size([8140, 36])
04-Mar-25 18:24:48 - Test experience 4 Y shape: torch.Size([8140])
04-Mar-25 18:24:48 - Attacks in experience 0: ['Analysis', 'Generic', 'Normal']
04-Mar-25 18:24:48 - Percetage of normal in experience 0: 0.213719
04-Mar-25 18:24:48 - Attacks in experience 1: ['Backdoor', 'Normal']
04-Mar-25 18:24:48 - Percetage of normal in experience 1: 0.877461
04-Mar-25 18:24:48 - Attacks in experience 2: ['DoS', 'Normal', 'Reconnaissance']
04-Mar-25 18:24:48 - Percetage of normal in experience 2: 0.354409
04-Mar-25 18:24:48 - Attacks in experience 3: ['Exploits', 'Normal', 'Shellcode']
04-Mar-25 18:24:48 - Percetage of normal in experience 3: 0.266554
04-Mar-25 18:24:48 - Attacks in experience 4: ['Fuzzers', 'Normal', 'Worms']
04-Mar-25 18:24:48 - Percetage of normal in experience 4: 0.404938
04-Mar-25 18:24:48 - Beginning experiment 3/3
04-Mar-25 18:24:48 - Created single experiment dataframe with columns: <NumpyExtensionArray>
[      'Train Experience',        'Test Experience', 'trivial val 3 Std (F1)',
 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)',           'best f1 (F1)',
                'roc auc',                 'pr auc']
Length: 8, dtype: object
04-Mar-25 18:24:48 - Using PassThroughExtractor
04-Mar-25 18:24:48 - Fitting and testing feature extractor: PassThroughExtractor() and anomaly score method: <AnomolyDetectors.PCA.PCA_model object at 0x0000022617A8FE90>
04-Mar-25 18:24:48 - --------- Beginning train experience 0 ----------
04-Mar-25 18:24:48 - X size: torch.Size([62554, 36]), y size: torch.Size([62554])
04-Mar-25 18:24:48 - Fitting feature extractor
04-Mar-25 18:24:48 - Encoding init normal data
04-Mar-25 18:24:48 - Fitting anomaly score method
04-Mar-25 18:24:48 - Fit anomaly score method
04-Mar-25 18:24:48 - Train Time: 0.016000
04-Mar-25 18:24:48 - --------- Testing all experiences ---------
04-Mar-25 18:24:48 - Scores Val Statisitcs: 0.026081, 0.012852
04-Mar-25 18:24:48 - Testing Experience 0
04-Mar-25 18:24:48 - Scores: [0.0483693  0.05072172 0.01116337 ... 0.06411712 0.00865191 0.03155003]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:24:48 - Best F1 threshold : 0.015742637
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.02159654455287154, 0.6456461362522463, 0.8832887759126967, 0.9270797143408608, 0.9264414610204467, 0.9747975114813499]
04-Mar-25 18:24:48 - Testing Experience 1
04-Mar-25 18:24:48 - Scores: [0.00814886 0.00732687 0.04579462 ... 0.01173072 0.01720167 0.02255892]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:24:48 - Best F1 threshold : 0.028300874
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.008565310492505354, 0.20512820512820512, 0.357429718875502, 0.362453531598513, 0.7398264541121684, 0.2937055100362133]
04-Mar-25 18:24:48 - Testing Experience 2
04-Mar-25 18:24:48 - Scores: [0.01123601 0.0299998  0.0143454  ... 0.01797525 0.01370168 0.05761561]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:24:48 - Best F1 threshold : 0.010798967
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.011614401858304297, 0.16953762466001812, 0.40793908375983023, 0.7985850725150336, 0.6737100020046403, 0.7707891181394906]
04-Mar-25 18:24:48 - Testing Experience 3
04-Mar-25 18:24:48 - Scores: [0.01289148 0.01258205 0.03403194 ... 0.00523089 0.02244576 0.01358563]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:24:48 - Best F1 threshold : 0.011148947
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.013517862890247827, 0.16989099479524697, 0.5037267080745341, 0.8622824550285185, 0.7448327888327888, 0.8697576664221641]
04-Mar-25 18:24:48 - Testing Experience 4
04-Mar-25 18:24:48 - Scores: [0.01558471 0.11856928 0.01227968 ... 0.00740016 0.00745337 0.0204697 ]
04-Mar-25 18:24:48 - Trivial percentile value 3std : 0.10104229137301436
04-Mar-25 18:24:48 - Trivial percentile value 2std : 0.052806036174297334
04-Mar-25 18:24:48 - Trivial percentile value 1std : 0.03072235494852066
04-Mar-25 18:24:48 - Best F1 threshold : 0.006307784
04-Mar-25 18:24:48 - Metrics: ['trivial val 3 Std (F1)', 'trivial val 2 Std (F1)', 'trivial val 1 Std (F1)', 'best f1 (F1)', 'roc auc', 'pr auc']
04-Mar-25 18:24:48 - Metric Scores [0.0020881186051367718, 0.09929356357927786, 0.30668198982104744, 0.7434505546377154, 0.6029399159703881, 0.6670464462302762]
04-Mar-25 18:24:48 - Inference Time: 0.170763
04-Mar-25 18:24:48 - --------- Beginning train experience 1 ----------
04-Mar-25 18:24:48 - Feature Extractor is None and experience is not 0. Skipping
04-Mar-25 18:24:48 - Train Time Statistics: 0.016000, nan
04-Mar-25 18:24:48 - Inference Time Statistics: 0.170763, nan
04-Mar-25 18:24:48 - Finished experiment 3/3
04-Mar-25 18:24:48 - Traceback (most recent call last):
  File "<ipython-input-3-1eddd84d188e>", line 67, in <module>
    main.run_experiments(experiment, device)
  File "c:\Users\seant\Desktop\Current Programs\CND-IDS\main.py", line 63, in run_experiments
    results_df.to_csv(f"results/{results_filename}.csv")
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\core\generic.py", line 3967, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\formats\format.py", line 1014, in to_csv
    csv_formatter.save()
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\formats\csvs.py", line 251, in save
    with get_handle(
         ^^^^^^^^^^^
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\common.py", line 749, in get_handle
    check_parent_directory(str(handle))
  File "c:\Users\seant\anaconda3\Lib\site-packages\pandas\io\common.py", line 616, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: 'results'

